<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
<head>
<!-- 2019-02-18 Mon 14:02 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aufgaben &#x2013; Lösungen</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Johannes Brauer" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="mystyle.css" />
<style type="text/css">
ol { list-style-type: lower-alpha; }
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Aufgaben &#x2013; Lösungen
<br />
<span class="subtitle">Einführung in die Programmierung</span>
</h1>
<div id="table-of-contents">
<h2>Inhaltsverzeichnis</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org463e1a1">1. Aufgabe (Erste Schritte in Racket)</a></li>
<li><a href="#orgc1afe8b">2. Aufgabe (Auswertung arithmetischer Ausdrücke)</a></li>
<li><a href="#orgcbb75ab">3. Aufgabe (Aufschreiben elementarer Funktionen)</a></li>
<li><a href="#orgebf3cc3">4. Aufgabe (Aufschreiben elementarer Funktionen)</a></li>
<li><a href="#org12fe68a">5. Aufgabe (Anwenden der Aufschreibregeln)</a></li>
<li><a href="#org9102853">6. Aufgabe (Profit für den Kinobesitzer)</a></li>
<li><a href="#org150a3d4">7. Aufgabe (Modifikation von <code>kino.rkt</code>)</a></li>
<li><a href="#orgf08b44e">8. Aufgabe (Einsatz von Hilfsfunktionen)</a></li>
<li><a href="#orgbca6c8c">9. Aufgabe (Ersetzungsmodell)</a></li>
<li><a href="#org6327b8a">10. Aufgabe (bedingte Funktion)</a></li>
<li><a href="#orgd117920">11. Aufgabe (Zusatzaufgaben zu bedingten Funktionen)</a></li>
<li><a href="#datenabstraktion">12. Aufgabe (Datenabstraktion)</a></li>
<li><a href="#org836d61c">13. Aufgabe (Datenabstraktion &#x2013; Zusatzaufgabe)</a>
<ul>
<li><a href="#org7f81bef">13.1. Vorbemerkungen</a></li>
<li><a href="#orgea95dc8">13.2. Aufgabenstellungen</a></li>
</ul>
</li>
<li><a href="#org816eca3">14. Aufgabe (Datenabstraktion &#x2013; gemischte Daten)</a></li>
<li><a href="#org84a3379">15. Aufgabe (Datenabstraktion &#x2013; gemischte Daten &#x2013; Zusatzaufgabe)</a>
<ul>
<li><a href="#org33eb8c0">15.1. Vorbemerkung</a></li>
<li><a href="#orgb8977bf">15.2. Aufgabenstellungen</a></li>
</ul>
</li>
<li><a href="#listenkonstruktion">16. Aufgabe (Listenkonstruktion und -zerlegung)</a></li>
<li><a href="#orgbf428a6">17. Aufgabe (Listenverarbeitung)</a></li>
<li><a href="#org0aff39c">18. Aufgabe (Funktionen über zwei Listen)</a></li>
<li><a href="#formaleaspekte">19. Aufgabe (Formale Aspekte)</a></li>
<li><a href="#org3092624">20. Aufgabe (lokale Definitionen)</a></li>
<li><a href="#org475849f">21. Aufgabe (Listen über gemischten Daten &#x2013; Zusatzaufgabe)</a></li>
<li><a href="#akkumulierendeparameter">22. Aufgabe (Hilfsfunktionen mit akkumulierenden Parametern)</a></li>
<li><a href="#fho">23. Aufgabe (Anwendung von <code>map</code>, <code>filter</code> und <code>reduce</code>)</a></li>
<li><a href="#orgae7bb50">24. Aufgabe (Definition von Funktionen höherer Ordnung)</a></li>
</ul>
</div>
</div>

<div id="outline-container-org463e1a1" class="outline-2">
<h2 id="org463e1a1"><span class="section-number-2">1</span> Aufgabe (Erste Schritte in Racket)</h2>
<div class="outline-text-2" id="text-1">
<p>
Machen Sie sich mit den NORDAKADEMIE-Rechnern vertraut und richten Sie
Ihren Arbeitsplatz ein (Mail, Webbrowser, Verzeichnisse für die
Vorlesungen usw.).  
</p>

<p>
Finden und starten Sie DrRacket nach den Anweisungen in der Vorlesung.
Werten Sie einen ersten Ausdruck aus, z. B. (* 6 7). 
</p>

<p>
Welche Funktion haben die Buttons? Welche Menü-Befehle verstehen Sie
schon?
</p>

<p>
Schauen Sie sich in einem Webbrowser die Seiten zu Racket unter
<a href="https://racket-lang.org/">https://racket-lang.org/</a> an. Wo finden Sie Hilfe zur Bedienung von
DrRacket? Wie können Sie sich über die Sprache Racket informieren? Wo
finden Sie alle vordefinierten mathematischen Funktionen?
</p>
</div>
</div>

<div id="outline-container-orgc1afe8b" class="outline-2">
<h2 id="orgc1afe8b"><span class="section-number-2">2</span> Aufgabe (Auswertung arithmetischer Ausdrücke)</h2>
<div class="outline-text-2" id="text-2">
<ol class="org-ol">
<li>Wie wird der Ausdruck<br />
<code>(* (+ 2 2) (/ (* (+ 3 5) (/ 30 10)) 2))</code> <br />
ausgewertet?</li>
<li>Experimentieren Sie mit verschiedenen Operatoren und Zahlenarten.</li>
<li><p>
Werten Sie die folgenden Ausdrücke aus und vergleichen Sie die Resultate:
</p>
<pre class="example">
(- 1.0 0.9)
(- 1000.0 999.9) 
(- #i1000.0 #i999.9)
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-orgcbb75ab" class="outline-2">
<h2 id="orgcbb75ab"><span class="section-number-2">3</span> Aufgabe (Aufschreiben elementarer Funktionen)</h2>
<div class="outline-text-2" id="text-3">
<p>
Schreiben Sie für die folgenden mathematischen Formeln Racket-Funktionsdefinitionen auf:
</p>

<ol class="org-ol">
<li><p>
\(n^2 + 1\)
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fa</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* n n<span style="color: #709870;">)</span> 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
\(\frac{1}{2}n^2 + 3\)
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fb</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>/ <span style="color: #907373;">(</span>* n n<span style="color: #907373;">)</span> 2<span style="color: #709870;">)</span> 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
\(2 - \frac{1}{n}\)
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fc</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>- 2 <span style="color: #709870;">(</span>/ 1 n<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
<p>
Geben Sie die Racket-Funktionen in das Definitionsfenster von
DrRacket ein. Geben Sie anschließend in das Interaktionsfenster
Funktionsaufrufe für diese Funktionen ein.
</p>
</div>
</div>
<div id="outline-container-orgebf3cc3" class="outline-2">
<h2 id="orgebf3cc3"><span class="section-number-2">4</span> Aufgabe (Aufschreiben elementarer Funktionen)</h2>
<div class="outline-text-2" id="text-4">
<p>
In der Praxis findet der Programmierer selten mathematische Formeln
   vor. Aufgabenstellungen sind eher als Prosatext gegeben. Die
   Berechnungsformeln muss er selbst entwickeln durch 
</p>
<ul class="org-ul">
<li>eigenes Nachdenken,</li>
<li>Nachschlagen in geeigneten Quellen oder</li>
<li>Nachfragen beim Auftraggeber.</li>
</ul>
<p>
Finden Sie für die folgenden Aufgabenstellungen die passenden
   Formeln und schreiben Sie diese als Funktionsdefinitionen in
   <i>Racket</i> auf: 
</p>
<ol class="org-ol">
<li><p>
Berechnung des Rauminhalts eines Quaders aus dessen Länge, Breite und Höhe.  
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">quader-volumen</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>laenge breite hoehe<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>* laenge breite hoehe<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Schreiben Sie eine Funktion, die aus der Entfernung und der
Geschwindigkeit zweier Züge die Zeit ermittelt, nach der die
Züge sich treffen, wenn Sie sich auf einem gemeinsamen
Streckenabschnitt von ihren jeweiligen Startpunkten aus
aufeinander zu bewegen. 
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">zug-treffen</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>entfernung geschwndgkt1 geschwndgkt2<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>/ entfernung <span style="color: #709870;">(</span>+ geschwndgkt1 geschwndgkt2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Berechnung der Miete, die eine andere Spielerin in Monopoly
bezahlen muss, falls sie auf einen Bahnhof trifft, der einer
anderen Spielerin gehört. Die Miete ist davon abhängig wie viele
Bahnhöfe der anderen Spielerin gehören:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Anzahl der Bahnhöfe</th>
<th scope="col" class="org-right">Miete</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">500</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">1000</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">2000</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">4000</td>
</tr>
</tbody>
</table>
<p>
Hinweis: Ein Aufruf <code>(expt x y)</code> liefert \(x^y\) als Ergebnis.
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bahnhofsmiete</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>anzahl-bahnhoefe<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>* 500 <span style="color: #709870;">(</span>expt 2 <span style="color: #907373;">(</span>- anzahl-bahnhoefe 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org12fe68a" class="outline-2">
<h2 id="org12fe68a"><span class="section-number-2">5</span> Aufgabe (Anwenden der Aufschreibregeln)</h2>
<div class="outline-text-2" id="text-5">
<p>
Schreiben Sie die Funktion zur Berechnung der Bahnhofsmiete in
Monopoly (s. o.) gemäß den Regeln 1 bis 3 aus der Vorlesung auf.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Bahnhofsmiete aus der Anzahl der Bahnh&#246;fe</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bahnhofsmiete</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>anzahl-bahnhoefe<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* 500 <span style="color: #709870;">(</span>expt 2 <span style="color: #907373;">(</span>- anzahl-bahnhoefe 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>bahnhofsmiete 4<span style="color: #7388D6;">)</span> 4000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>bahnhofsmiete 3<span style="color: #7388D6;">)</span> 2000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>bahnhofsmiete 2<span style="color: #7388D6;">)</span> 1000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>bahnhofsmiete 1<span style="color: #7388D6;">)</span>  500<span style="color: #707183;">)</span>
</pre>
</div>

<p>
<b>Wenn nichts anderes angeben ist, sind auch die Funktionen für die
folgenden Aufgaben gemäß diesen Regeln aufzuschreiben!!!</b>
</p>
</div>
</div>

<div id="outline-container-org9102853" class="outline-2">
<h2 id="org9102853"><span class="section-number-2">6</span> Aufgabe (Profit für den Kinobesitzer)</h2>
<div class="outline-text-2" id="text-6">
<p>
Ein altmodisches Vorstadtkino besitzt eine einfache Formel für die
Berechnung des Profits einer Vorstellung: Jeder Kinobesucher
bezahlt 500 Währungseinheiten für die Eintrittskarte. Jede
Vorstellung kostet das Kino 2000 Währungseinheiten plus 50
Währungseinheiten pro Besucher. Schreiben Sie eine Funktion <code>profit</code> zur
Berechnung des Profits bei gegebener Besucherzahl.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet den Profit eine Filmvorfuehrung aus 2000 WE Fixkosten</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">und 50 WE Kosten pro Besucher bei gegebener Besucherzahl und</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">500 WE Kartenpreis</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">profit</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>besucherzahl<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>* 500 besucherzahl<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 50 besucherzahl<span style="color: #907373;">)</span> 2000<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>profit 100<span style="color: #7388D6;">)</span> 43000<span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org150a3d4" class="outline-2">
<h2 id="org150a3d4"><span class="section-number-2">7</span> Aufgabe (Modifikation von <code>kino.rkt</code>)</h2>
<div class="outline-text-2" id="text-7">
<ol class="org-ol">
<li>Modifizieren Sie das Programm <code>kino.rkt</code> so, dass die Fixkosten
einer Veranstaltung wegfallen und dafür 15 Währungseinheiten pro
Besucher an Kosten anfallen.</li>
<li>Nehmen Sie die gleiche Modifikation auch an der Funktion <code>profit</code>
aus der Vorlesung vor, die ohne Hilfsfunktionen auskommt, und
vergleichen Sie die Ergebnisse.</li>
</ol>
</div>
</div>

<div id="outline-container-orgf08b44e" class="outline-2">
<h2 id="orgf08b44e"><span class="section-number-2">8</span> Aufgabe (Einsatz von Hilfsfunktionen)</h2>
<div class="outline-text-2" id="text-8">
<p>
Die folgenden Aufgaben sind unter Benutzung von Hilfsfunktionen zu
lösen. Befolgen Sie unbedingt alle in der Vorlesung angegebenen Regeln:
</p>
<ol class="org-ol">
<li>Schreiben Sie ein Programm, das das Volumen eines Zylinders zu
berechnen erlaubt. Eingangsgrößen sind der Radius und die Höhe des Zylinders.</li>
<li>Schreiben Sie ein Programm, das die Oberfläche eines Zylinders zu
berechnen erlaubt. Eingangsgrößen sind der Radius und die Höhe des Zylinders.</li>
<li>Schreiben Sie ein Programm, das die Oberfläche eines Rohrs zu
berechnen erlaubt. Eingangsgrößen sind der Innenradius, die
Wandstärke und die Länge des Rohrs.</li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;;;;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sung von Simon Gre&#223;mann, I18b ;;;;;</span>
<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Aufgabe 8a</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">mein-pi</span> 3.14<span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet Kreisfl&#228;che aus Radius</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Kreisflaeche</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>radius<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* radius radius mein-pi<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Kreisflaeche 1<span style="color: #7388D6;">)</span> 3.14<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Kreisflaeche 2<span style="color: #7388D6;">)</span> 12.56<span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet das Volumen eines Zylinders in Abh&#228;ngigkeit von Radius und H&#246;he</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Zylindervolumen</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>willi hoehe<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span>Kreisflaeche willi<span style="color: #709870;">)</span> hoehe<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Zylindervolumen 1 1<span style="color: #7388D6;">)</span> 3.14<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Aufgabe 8b</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet den Umfang eines Kreises in Anh&#228;ngigkeit von Pi.</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Kreisumfang</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>radius<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* 2 mein-pi radius<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Kreisumfang 1<span style="color: #7388D6;">)</span> 6.28<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet die Mantelfl&#228;che eines Zylinders in Abh&#228;ngigkeit von Radius und H&#246;he</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Mantelflaeche</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">(</span>radius hoehe<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span>Kreisumfang radius<span style="color: #709870;">)</span> hoehe<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Mantelflaeche 1 1<span style="color: #7388D6;">)</span> 6.28<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Mantelflaeche 2 1<span style="color: #7388D6;">)</span> 12.56<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet die Oberfl&#228;che eines Zylinders in Abh&#228;ngigkeit von Radius und H&#246;he</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Zylinderoberflaeche</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>radius hoehe<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 2 <span style="color: #907373;">(</span>Kreisflaeche radius<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>Mantelflaeche radius hoehe<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Zylinderoberflaeche 1 1<span style="color: #7388D6;">)</span> 12.56<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Aufgabe 8c</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet die Fl&#228;che eines Kreisrings in Abh&#228;ngigkeit von innenradius und Breite</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Kreisringflaeche</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>innenradius breite<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>Kreisflaeche <span style="color: #907373;">(</span>+ innenradius breite<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>Kreisflaeche innenradius<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Kreisringflaeche 1 1<span style="color: #7388D6;">)</span> 9.42<span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Berechnet die Oberfl&#228;che eines Rohrs in Abh&#228;ngigkeit von dessen Inneradius, Wandst&#228;rke und L&#228;nge.</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">Rohroberflaeche</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>innenradius wandstaerke laenge<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>Mantelflaeche <span style="color: #907373;">(</span>+ innenradius wandstaerke<span style="color: #907373;">)</span> laenge<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>Mantelflaeche innenradius laenge<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>* 2 <span style="color: #907373;">(</span>Kreisringflaeche innenradius &lt;dstaerke<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>Rohroberflaeche 1 1 1<span style="color: #7388D6;">)</span> 37.68<span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbca6c8c" class="outline-2">
<h2 id="orgbca6c8c"><span class="section-number-2">9</span> Aufgabe (Ersetzungsmodell)</h2>
<div class="outline-text-2" id="text-9">
<p>
Gegeben sei die folgende Funktionsdefinition:
</p>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">f</span>
       <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span>
           <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
Werten Sie die folgenden Ausdrücke Schritt für Schritt unter Anwendung
des Ersetzungsmodells aus:
</p>
<ol class="org-ol">
<li><p>
<code>(f 1 (* 2 3))</code>
</p>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span>f 1 <span style="color: #7388D6;">(</span>* 2 3<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1 <span style="color: #7388D6;">(</span>* 2 3<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1 6<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>* 3 1<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>* 6 6<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ 3 36<span style="color: #707183;">)</span>
    = 39
</pre>
</div></li>
<li><p>
<code>(+ (f 1 2) (f 2 1))</code>
</p>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>f 1 2<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>f 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 1 2<span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>* 3 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>* 2 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 
         <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>* 3 2<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>* 1 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>+ 3 4<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>+ 6 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ 7 7<span style="color: #707183;">)</span>
    = 14  
</pre>
</div>

<p>
Ausführlich:
</p>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>f 1 2<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>f 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 1 2<span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span>f 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 1 2<span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>* 3 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>* 2 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span><span style="color: #709870;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #907373;">[</span>x y<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>* 3 x<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>* y y<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 2 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
    = <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* 2 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span> 
         <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 2<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* 1 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
    = <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>* 3 4<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 2<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* 1 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
    = <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>+ 3 4<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>+ 6 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
    = <span style="color: #7388D6;">(</span>+ 7 <span style="color: #909183;">(</span>+ 6 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
    = <span style="color: #7388D6;">(</span>+ 7 7<span style="color: #7388D6;">)</span>
    = 14     
</pre>
</div></li>
<li><p>
<code>(f (f 1 (* 2 3)) 19)</code>
</p>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span>f <span style="color: #7388D6;">(</span>f 1 <span style="color: #909183;">(</span>* 2 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>f 1 <span style="color: #909183;">(</span>* 2 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 
         <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 1 <span style="color: #909183;">(</span>* 2 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 
         <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x y<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>* 3 x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* y y<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> 1 6<span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 
         <span style="color: #7388D6;">(</span>+ <span style="color: #909183;">(</span>* 3 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>* 6 6<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>+ 3 36<span style="color: #7388D6;">)</span> 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3 x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* y y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 39 19<span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>* 3 39<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>* 19 19<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    = <span style="color: #707183;">(</span>+ 117 361<span style="color: #707183;">)</span>
    = 478
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org6327b8a" class="outline-2">
<h2 id="org6327b8a"><span class="section-number-2">10</span> Aufgabe (bedingte Funktion)</h2>
<div class="outline-text-2" id="text-10">
<p>
Schreiben Sie ein Programm, das aus dem Bruttoeinkommen eines
Arbeitnehmers, das sich aus der Anzahl der Arbeitsstunden und seinem
Bruttostundenlohn ergibt, sein Nettoeinkommen durch Abzug der
Einkommensteuer berechnet. Die Einkommensteuer wird dabei nach einem
steuererklärungaufbierdeckelgeeigneten Tarif ermittelt, der
folgendermaßen definiert ist:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><b>Einkommen</b></th>
<th scope="col" class="org-right"><b>Steuersatz</b> [%]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(<= 5000\)</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">\(> 5000\; und \leq 10000\)</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">\(>10000\; und \leq 100000\)</td>
<td class="org-right">29</td>
</tr>

<tr>
<td class="org-left">\(>100000\)</td>
<td class="org-right">64</td>
</tr>
</tbody>
</table>

<p>
Der Steuersatz gilt immer nur für die Einkommensanteile in dem
jeweiligen Intervall.
</p>

<p>
Die Funktion <code>nettoeinkommen</code> soll nach folgendem Schema aufrufbar sein:
</p>

<pre class="example">
          (nettoeinkommen anzahl-arbeitsStunden stundenLohn)
</pre>

<p>
Hier noch ein paar Testvorgaben:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 5001<span style="color: #7388D6;">)</span> 5000.85<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 10001<span style="color: #7388D6;">)</span> 9250.71<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 100001<span style="color: #7388D6;">)</span> 73150.36<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Hinweise:
</p>

<ol class="org-ol">
<li>Lesen Sie den Aufgabentext aufmerksam durch. Jeder Satz bedeutet
etwas.</li>

<li>Entwickeln Sie die Funktion gemäß den Regel 1 bis 6. Benutzen Sie
Hilfsfunktionen und machen von Variablendefinitionen (benannte
Konstanten, Regel 5) Gebrauch.</li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Steuertabelle gem&#228;&#223; Aufgabenstellung</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuergrenzeI</span> 5000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuergrenzeII</span> 10000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuergrenzeIII</span> 100000<span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuersatz1</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuersatz2</span> 15/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuersatz3</span> 29/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuersatz4</span> 64/100<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">feste Steuerbetr&#228;ge gem&#228;&#223; obiger Tabelle </span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuern-fuer-steuergrenzeI</span> <span style="color: #7388D6;">(</span>* steuersatz1 steuergrenzeI<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuern-fuer-steuergrenzeII</span>
  <span style="color: #7388D6;">(</span>+ steuern-fuer-steuergrenzeI
     <span style="color: #909183;">(</span>* steuersatz2 <span style="color: #709870;">(</span>- steuergrenzeII steuergrenzeI<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuern-fuer-steuergrenzeIII</span>
  <span style="color: #7388D6;">(</span>+ steuern-fuer-steuergrenzeII
     <span style="color: #909183;">(</span>* steuersatz3 <span style="color: #709870;">(</span>- steuergrenzeIII steuergrenzeII<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ermittlung des Einkommenssteuersatzes aus dem Einkommen gem&#228;&#223; obiger Tabelle</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steuersatz</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>einkommen<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>&lt;= einkommen steuergrenzeI<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>&gt;= einkommen 0<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> steuersatz1<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>&gt; einkommen steuergrenzeI<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>&lt;= einkommen steuergrenzeII<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> steuersatz2<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>&gt; einkommen steuergrenzeII<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>&lt;= einkommen steuergrenzeIII<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> steuersatz3<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&gt; einkommen steuergrenzeIII<span style="color: #907373;">)</span> steuersatz4<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #008000;">"steuersatz"</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz 2000<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz steuergrenzeI<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz 7500<span style="color: #7388D6;">)</span> 15/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz steuergrenzeII<span style="color: #7388D6;">)</span> 15/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz 50000<span style="color: #7388D6;">)</span> 29/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz steuergrenzeIII<span style="color: #7388D6;">)</span> 29/100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>steuersatz 1000000<span style="color: #7388D6;">)</span> 64/100<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Berechnung des Bruttoeinkommens eines Arbeitnehmers</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">der Anzahl der Arbeitsstunden und dem Bruttostundenlohn </span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bruttoeinkommen</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>arbeitsstunden stundenlohn<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* arbeitsstunden stundenlohn<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #008000;">"bruttoeinkommen"</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>bruttoeinkommen 10 5<span style="color: #7388D6;">)</span> 50<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ermittlung der Einkommensteuer aus dem einkommen </span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">gem&#228;&#223; Steuertarif in Aufgabenstellung</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">einkommensteuer</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>einkommen<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>steuersatz einkommen<span style="color: #6276BA;">)</span> steuersatz1<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>* steuersatz1 einkommen<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>steuersatz einkommen<span style="color: #6276BA;">)</span> steuersatz2<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>+ steuern-fuer-steuergrenzeI
          <span style="color: #6276BA;">(</span>* steuersatz2 <span style="color: #858580;">(</span>- einkommen steuergrenzeI<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>steuersatz einkommen<span style="color: #6276BA;">)</span> steuersatz3<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>+ steuern-fuer-steuergrenzeII
          <span style="color: #6276BA;">(</span>* steuersatz3 <span style="color: #858580;">(</span>- einkommen steuergrenzeII<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>steuersatz einkommen<span style="color: #6276BA;">)</span> steuersatz4<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>+ steuern-fuer-steuergrenzeIII
          <span style="color: #6276BA;">(</span>* steuersatz4 <span style="color: #858580;">(</span>- einkommen steuergrenzeIII<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #008000;">"einkommensteuer"</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer 2000<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer steuergrenzeI<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer 8000<span style="color: #7388D6;">)</span> 450<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer steuergrenzeII<span style="color: #7388D6;">)</span> 750<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer 50000<span style="color: #7388D6;">)</span> 12350<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer steuergrenzeIII<span style="color: #7388D6;">)</span> 26850<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>einkommensteuer 100100<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>+ 26850 64<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Berechnung des Nettolohns eines Arbeitnehmers aus</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Anzahl Arbeisstunden und Bruttostundenlohn (in Euro)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">nettoeinkommen</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>arbeitsstunden stundenlohn<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>bruttoeinkommen arbeitsstunden stundenlohn<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>einkommensteuer <span style="color: #907373;">(</span>bruttoeinkommen arbeitsstunden stundenlohn<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
<span style="color: #008000;">"nettoeinkommen"</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 5001<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 500085 100<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 10001<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 925071 100<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>nettoeinkommen 1 100001<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 7315036 100<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd117920" class="outline-2">
<h2 id="orgd117920"><span class="section-number-2">11</span> Aufgabe (Zusatzaufgaben zu bedingten Funktionen)</h2>
<div class="outline-text-2" id="text-11">
<ol class="org-ol">
<li><p>
Eine Kreditkartengesellschaft gewährt ihren Kunden nach
Jahresumsatz gestaffelte Rückerstattung von
Kreditkartenbelastungen. Die Rückerstattungen könnten z. B. wie 
folgt aussehen:
</p>
<ul class="org-ul">
<li>ein viertel Prozent für die ersten 500€ des Jahresumsatzes (nur
Belastungen keine Gutschriften werden gezählt),</li>
<li>ein halbes Prozent für die nächsten 1000€, d. h. für den
Umsatzanteil zwischen 500€ und 1500€,</li>
<li>ein dreiviertel Prozent für die nächsten 1000€, d. h. für den
Umsatzanteil zwischen 1500€ und 2500€ und</li>
<li>ein Prozent für die Umsatzanteile oberhalb von 2500€.</li>
</ul>
<p>
Ein Kunde mit einem Umsatz von 400€ erhält demnach eine Gutschrift
von 1€ (\(= \frac{1}{4} \cdot \frac{1}{100} \cdot 400\)). Ein Kunde
mit einem Umsatz von 1400€ erhält eine Gutschrift von 5,75€:
</p>
<ul class="org-ul">
<li>1,25€ (\(= \frac{1}{4} \cdot \frac{1}{100} \cdot 500\)) für die
ersten 500€ plus</li>
<li>4,50€ (\(=\frac{1}{2} \cdot \frac{1}{100} \cdot 900\)) für die
nächsten 900€</li>
</ul>
<p>
Lösen Sie die folgenden Teilaufgaben
</p>
<ol class="org-ol">
<li>Bestimmen Sie manuell die Gutschriften für Umsätze 2000€ und
2600€.</li>
<li>Schreiben Sie eine Funktion <code>rueckerstattung</code>, die einen Umsatz
als Argument akzeptiert und den Rückerstattungsbetrag ermittelt.</li>
</ol>
<p>
<br />
</p>
<div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die R&#252;ckerstattung f&#252;r Ums&#228;tze zwischen 0 and 500</span>
      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">rueckerstattung-0-500</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>* a <span style="color: #709870;">(</span>* .25 1/100<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung-0-500 400<span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
         
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die R&#252;ckerstattung f&#252;r Ums&#228;tze zwischen 500 and 1500</span>
      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">rueckerstattung-500-1500</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a<span style="color: #909183;">]</span> 
          <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>rueckerstattung-0-500 500<span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>- a 500<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* .50 1/100<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung-500-1500 1400<span style="color: #7388D6;">)</span> 5.75<span style="color: #707183;">)</span>
         
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die R&#252;ckerstattung f&#252;r Ums&#228;tze zwischen 1500 and 2500</span>
      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">rueckerstattung-1500-2500</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>rueckerstattung-500-1500 1500<span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>- a 1500<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* .75 1/100<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung-1500-2500 2000<span style="color: #7388D6;">)</span> 10.00<span style="color: #707183;">)</span>
         
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die R&#252;ckerstattung f&#252;r Ums&#228;tze von 2500 und h&#246;her</span>
      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">rueckerstattung-2500+</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>rueckerstattung-1500-2500 2500<span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>- a 2500<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* 1 1/100<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung-2500+ 2600<span style="color: #7388D6;">)</span> 14.75<span style="color: #707183;">)</span>
         
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet R&#252;ckerstattungsbetrag f&#252;r Kreditkarteninhaber</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">bei einem bestimmten Jahresumsatz</span>
      <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">rueckerstattung</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>umsatz<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&lt;= umsatz 500<span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>rueckerstattung-0-500 umsatz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>&gt; umsatz 500<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>&lt;= umsatz 1500<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>rueckerstattung-500-1500 umsatz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>&gt; umsatz 1500<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>&lt;= umsatz 2500<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>rueckerstattung-1500-2500 umsatz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #709870;">[</span>else
             <span style="color: #907373;">(</span>rueckerstattung-2500+ umsatz<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendungen</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung 400<span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung 1400<span style="color: #7388D6;">)</span> 5.75<span style="color: #707183;">)</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung 2000<span style="color: #7388D6;">)</span> 10.00<span style="color: #707183;">)</span>
      <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>rueckerstattung 2600<span style="color: #7388D6;">)</span> 14.75<span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Wieviele reelle Lösungen besitzt eine quadratische Gleichung
\[ax^2 + bx + c = 0\] 
für beliebige Koeffizienten \(a\), \(b\) und \(c\)?
</p>
<ol class="org-ol">
<li>Betrachten Sie zunächst nur <i>echte</i> quadratische
Gleichungen, d. h. es gilt \(a\neq0\)</li>
<li>Erweitern Sie die Lösung so, dass auch der Fall \(a=0\) korrekt
behandelt wird.</li>
</ol>

<p>
<b>Lösung:</b>
Die Lösungen der quadratischen Gleichung
\[ax^2 + bx + c = 0\] 
können für den Fall a≠0 mit der Formel
\[L_{q}: x_{1,2}=\frac{-b\pm\sqrt{b^2-4ac}}{2a}\]
berechnet werden. Für den Fall a=0 gibt es eine Lösung -c/b, vorausgesetzt b≠0.
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet der Radikanden der L&#246;sungsformel</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">radikand</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a b c<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>sqr b<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* 4 a c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">: Beispielanwendungen</span>
   <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>radikand 1 2 1<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>radikand 1 1 1<span style="color: #7388D6;">)</span> -3<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>= <span style="color: #7388D6;">(</span>radikand 1 3 1<span style="color: #7388D6;">)</span> 5<span style="color: #707183;">)</span>
   
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Anzahl der L&#246;sungen einer quadratischen Gleichung mit</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">den Koeffizienten a, b und c</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">anzahl-loesungen</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a b c<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= 0 a<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span>
                    <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>= 0 b c<span style="color: #858580;">)</span> <span style="color: #008000;">"unendlich viele L&#246;sungen"</span><span style="color: #6276BA;">]</span>
                    <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>= 0 b<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>not <span style="color: #887070;">(</span>= 0 c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #008000;">"keine L&#246;sung"</span><span style="color: #6276BA;">]</span>
                    <span style="color: #6276BA;">[</span>else <span style="color: #008000;">"eine L&#246;sung"</span><span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>&gt; <span style="color: #80A880;">(</span>radikand a b c<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span> <span style="color: #008000;">"zwei L&#246;sungen"</span><span style="color: #6276BA;">]</span>
                     <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span>radikand a b c<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span> <span style="color: #008000;">"eine L&#246;sung"</span><span style="color: #6276BA;">]</span>
                     <span style="color: #6276BA;">[</span>else <span style="color: #008000;">"keine L&#246;sung"</span><span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendugen</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 0 0 0<span style="color: #7388D6;">)</span> <span style="color: #008000;">"unendlich viele L&#246;sungen"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 0 0 1<span style="color: #7388D6;">)</span> <span style="color: #008000;">"keine L&#246;sung"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 0 1 2<span style="color: #7388D6;">)</span> <span style="color: #008000;">"eine L&#246;sung"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 1 4 1<span style="color: #7388D6;">)</span> <span style="color: #008000;">"zwei L&#246;sungen"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 1 2 1<span style="color: #7388D6;">)</span> <span style="color: #008000;">"eine L&#246;sung"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>anzahl-loesungen 4 1 1<span style="color: #7388D6;">)</span> <span style="color: #008000;">"keine L&#246;sung"</span><span style="color: #707183;">)</span>
   
   <span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
   <span style="color: #8D8D84;">;;; </span><span style="color: #8D8D84; font-style: italic;">Funktion zur Berechnung der L&#246;sungen einer quadratischen Gleichung;;;</span>
   <span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
   
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine quadgl-loesung ist ein Wert</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">(make-quadgl-loesung art x1 x2)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">wobei art die Anzahl der L&#246;sungen durch eine Zeichenkette</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">("trivial" "keine" "eine" "zwei") repr&#228;sentiert wird und</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">x1, x2 ggf. die L&#246;sungen enthalten</span>
   <span style="color: #707183;">(</span>define-struct quadgl-loesung <span style="color: #7388D6;">[</span>art x1 x2<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
   
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die L&#246;sungen einer quadratischen Gleichung mit</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">den Koeffizienten a, b und c</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">loesungen</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a b c<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= 0 a<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span>
                    <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>= 0 b c<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"trivial"</span> 0 0<span style="color: #858580;">)</span><span style="color: #6276BA;">]</span>
                    <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>= 0 b<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>not <span style="color: #887070;">(</span>= 0 c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"keine"</span> 0 0<span style="color: #858580;">)</span><span style="color: #6276BA;">]</span>
                    <span style="color: #6276BA;">[</span>else <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"eine"</span> <span style="color: #80A880;">(</span>/ <span style="color: #887070;">(</span>- c<span style="color: #887070;">)</span> b<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span><span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>&gt; <span style="color: #80A880;">(</span>radikand a b c<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span>
                      <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"zwei"</span>
                                           <span style="color: #80A880;">(</span>/ <span style="color: #887070;">(</span>+ <span style="color: #707183;">(</span>- b<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>sqrt <span style="color: #7388D6;">(</span>radikand a b c<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                              <span style="color: #887070;">(</span>* 2 a<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                           <span style="color: #80A880;">(</span>/ <span style="color: #887070;">(</span>- <span style="color: #707183;">(</span>- b<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>sqrt <span style="color: #7388D6;">(</span>radikand a b c<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                              <span style="color: #887070;">(</span>* 2 a<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">]</span> 
                     <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span>radikand a b c<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span>
                      <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"eine"</span> <span style="color: #80A880;">(</span>/ <span style="color: #887070;">(</span>- b<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>* 2 a<span style="color: #887070;">)</span><span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span><span style="color: #6276BA;">]</span>
                     <span style="color: #6276BA;">[</span>else <span style="color: #858580;">(</span>make-quadgl-loesung <span style="color: #008000;">"keine"</span> 0 0<span style="color: #858580;">)</span><span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Beispielanwendugen</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>quadgl-loesung-art <span style="color: #909183;">(</span>loesungen 0 0 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"trivial"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>quadgl-loesung-art <span style="color: #909183;">(</span>loesungen 0 0 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"keine"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #7388D6;">(</span>string=? <span style="color: #909183;">(</span>quadgl-loesung-art <span style="color: #709870;">(</span>loesungen 0 1 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #008000;">"eine"</span><span style="color: #7388D6;">)</span>
        <span style="color: #7388D6;">(</span>= <span style="color: #909183;">(</span>quadgl-loesung-x1 <span style="color: #709870;">(</span>loesungen 0 1 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span> -2<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #7388D6;">(</span>string=? <span style="color: #909183;">(</span>quadgl-loesung-art <span style="color: #709870;">(</span>loesungen 1 4 3<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #008000;">"zwei"</span><span style="color: #7388D6;">)</span>
        <span style="color: #7388D6;">(</span>= <span style="color: #909183;">(</span>quadgl-loesung-x1 <span style="color: #709870;">(</span>loesungen 1 4 3<span style="color: #709870;">)</span><span style="color: #909183;">)</span> -1<span style="color: #7388D6;">)</span>
        <span style="color: #7388D6;">(</span>= <span style="color: #909183;">(</span>quadgl-loesung-x2 <span style="color: #709870;">(</span>loesungen 1 4 3<span style="color: #709870;">)</span><span style="color: #909183;">)</span> -3<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #7388D6;">(</span>string=? <span style="color: #909183;">(</span>quadgl-loesung-art <span style="color: #709870;">(</span>loesungen 1 2 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #008000;">"eine"</span><span style="color: #7388D6;">)</span>
        <span style="color: #7388D6;">(</span>= <span style="color: #909183;">(</span>quadgl-loesung-x1 <span style="color: #709870;">(</span>loesungen 1 2 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span> -1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>string=? <span style="color: #7388D6;">(</span>quadgl-loesung-art <span style="color: #909183;">(</span>loesungen 4 1 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"keine"</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-org46afbe0" class="outline-2">
<h2 id="datenabstraktion"><span class="section-number-2">12</span> Aufgabe (Datenabstraktion)</h2>
<div class="outline-text-2" id="text-datenabstraktion">
<p>
Gehen Sie für die Lösung der Aufgabe unter Anwendung der Regeln 7 und 8!
</p>

<ol class="org-ol">
<li><p>
Definieren Sie eine Datenstruktur für „Zeitpunkte seit
Mitternacht”, die aus den Komponenten <code>stunden</code>, <code>minuten</code> und
<code>sekunden</code> besteht.
</p>

<p>
Entwickeln Sie eine Funktion <code>zeit-&gt;sekunden</code>, die eine
   Zeitpunkt-seit-Mittnacht-Struktur verarbeitet und die seit
   Mitternacht vergangenen Sekunden berechnet.
</p></li>

<li><p>
Definieren Sie geeignete <b>Datenstrukturen</b> für Kreise, die durch
</p>

<ul class="org-ul">
<li>die Koordinaten des Mittelpunkts und</li>
<li>den Radius und</li>
</ul>

<p>
gegeben sind.
</p>

<p>
Schreiben Sie eine Funktion, die prüft, ob ein Punkt
   innerhalb eines Kreises liegt.
</p></li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Autor der L&#246;sungen zu Aufgabe 12: David L&#252;der (I16b)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Aufgabe 12a</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Eine Tageszeit ist ein Wert</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(make-daytime h m s)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">wobei h die Stunden, m die Minuten und s die Sekunden angeben, um die Uhrzeit</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">zu definieren.</span>
<span style="color: #707183;">(</span>define-struct daytime <span style="color: #7388D6;">[</span>h m s<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">gibt die absolute Zahl der vergangenen Sekunden seit Mitternacht bei gegebeher</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Tageszeit zur&#252;ck.</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>zeit-&gt;sekunden <span style="color: #909183;">(</span>make-daytime 0 0 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>zeit-&gt;sekunden <span style="color: #909183;">(</span>make-daytime 0 2 36<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 156<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>zeit-&gt;sekunden <span style="color: #909183;">(</span>make-daytime 2 1 50<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 7310<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>zeit-&gt;sekunden <span style="color: #909183;">(</span>make-daytime 23 59 59<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 86399<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">zeit-&gt;sekunden</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>uhrzeit<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>daytime-h uhrzeit<span style="color: #907373;">)</span> 3600<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>daytime-m uhrzeit<span style="color: #907373;">)</span> 60<span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>daytime-s uhrzeit<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Aufgabe 12b</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Ein Punkt ist ein Wert</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(make-point x y)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">wobei x und y Zahlen sind, welche die Position im Zweidimensionalen angeben.</span>
<span style="color: #707183;">(</span>define-struct point <span style="color: #7388D6;">[</span>x y<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Ein Kreis ist ein Wert</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(make-circle center radius)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">wobei center ein Punkt ist, welcher den Mittelpunkt darstellt und radius eine</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Zahl ist, welche den Radius des Kreises angibt.</span>
<span style="color: #707183;">(</span>define-struct circle <span style="color: #7388D6;">[</span>center radius<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">berechnet den Abstand zwischen zwei &#252;bergebenen Punkten im Zweidimensionalen</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>point-distance <span style="color: #909183;">(</span>make-point 1 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-point 1 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>point-distance <span style="color: #909183;">(</span>make-point 7 2<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-point 2 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 5<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-within <span style="color: #7388D6;">(</span>point-distance <span style="color: #909183;">(</span>make-point 5 5<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-point 2 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 3.16 3.17<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">point-distance</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>p1 p2<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>sqrt <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>sqr <span style="color: #6276BA;">(</span>- <span style="color: #858580;">(</span>point-x p1<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>point-x p2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>sqr <span style="color: #6276BA;">(</span>- <span style="color: #858580;">(</span>point-y p1<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>point-y p2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">pr&#252;ft, ob ein Punkt innerhalb eines Kreises liegt, dabei werden der Kreis und</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">der Punkt &#252;bergeben</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-point 10 10<span style="color: #709870;">)</span> 2<span style="color: #909183;">)</span>
                          <span style="color: #909183;">(</span>make-point 10 9<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-point 7 3<span style="color: #709870;">)</span> 5<span style="color: #909183;">)</span>
                          <span style="color: #909183;">(</span>make-point 2 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-point 9 2<span style="color: #709870;">)</span> 7<span style="color: #909183;">)</span>
                          <span style="color: #909183;">(</span>make-point 8 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">in-circle?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>circle point<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>&lt;= <span style="color: #709870;">(</span>point-distance <span style="color: #907373;">(</span>circle-center circle<span style="color: #907373;">)</span> point<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>circle-radius circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org836d61c" class="outline-2">
<h2 id="org836d61c"><span class="section-number-2">13</span> Aufgabe (Datenabstraktion &#x2013; Zusatzaufgabe)</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org7f81bef" class="outline-3">
<h3 id="org7f81bef"><span class="section-number-3">13.1</span> Vorbemerkungen</h3>
<div class="outline-text-3" id="text-13-1">
<p>
In den Lehrsprachen von DrRacket gibt es ein vordefinierte
Strukturdefinition namens <code>posn</code> für Punkte in der Ebene, die genauso
aufgebaut ist wie die Strukturdefinition <code>point</code> aus der
Vorlesung. Die damit vordefinierten Funktionen sind
</p>
<ul class="org-ul">
<li>die Konstruktionsfunktion <code>make-posn</code>,</li>
<li>die Selektionsfunktionen <code>posn-x</code> und <code>posn-y</code> und</li>
<li>das Typprädikat <code>posn?</code>.</li>
</ul>

<p>
Wenn man über den Menüpunkt <code>Sprache-&gt;Teachpack hinzufügen...</code> das
Teachpack <code>draw.rkt</code> auswählt und anschließend den <code>Start</code>-Knopf
drückt, steht ein Grafikpaket mit den folgenden Funktionen bereit:
</p>
<dl class="org-dl">
<dt><code>draw-solid-line</code></dt><dd>erwartet zwei Punkte (<code>posn</code>-Strukturen), die
den Anfang und das Ende einer Strecke definieren sowie eine Farbe
als Argumente</dd>
<dt><code>draw-solid-rect</code></dt><dd>erwartet vier Argumente: ein Punkt für die
linke obere Ecke des Rechtecks, zwei Zahlen für Breite und Höhe
des Rechecks und eine Farbe</dd>
<dt><code>draw-solid-disk</code></dt><dd>erwartet drei Argumente: ein Punkt für den
Mittelpunkt, eine Zahl für den Radius der Scheibe und eine Farbe</dd>
<dt><code>draw-circle</code></dt><dd>erwartet drei Argumente: ein Punkt für den
Mittelpunkt, eine Zahl für den Radius des Kreises und eine Farbe</dd>
</dl>
<p>
Alle Funktionen liefern als Funktionswert <code>true</code>, wobei wir in diesem Fall
an den Funktionswerten weniger interessiert sind als an ihrem
<b>Effekt</b>. Der besteht nämlich darin, dass die Prozeduren jeweils eine
Strecke, ein Rechteck, eine Scheibe und einen Kreis auf eine zuvor
definierte Zeichenfläche zeichnen.
</p>

<p>
Eine Zeichenfläche kann mit einem Ausdruck <code>(start x y)</code> erzeugt
werden, wobei <code>x</code> und <code>y</code> die Breite und die Höhe in Pixeln der
Zeichenfläche angeben. Zum Beispiel erzeugt ein Aufruf <code>(start 150
200)</code> die folgende Zeichenfläche: <img src="./Abbildungen/canvas.png" alt="canvas.png" /> Ein
Anwendungsbeispiel zeigt die folgende Abbildung:
<img src="./Abbildungen/drawings.png" alt="drawings.png" />
</p>

<p>
Der <b>Ursprung des Koordinatensystems</b> liegt in der linken oberen Ecke
der Zeichenfläche. Die x-Koordinate zählt nach rechts, die
y-Koordinate nach unten positiv:
<img src="http://www.htdp.org/2003-09-26/Book/curriculum1aa-Z-G-17.gif" alt="curriculum1aa-Z-G-17.gif" />
</p>

<p>
Die <b>Farben</b> werden durch Symbole wie '<code>yellow</code>, '<code>red</code>, '<code>green</code>
angegeben. Bitte beachten Sie das vorangestellte Hochkomma.
</p>

<p>
Für jede Zeichenoperation gibt es eine korrespondierende
<b>Löschoperation</b>: <code>clear-solid-line</code>, <code>clear-solid-rect</code>,
<code>clear-solid-disk</code> und <code>clear-circle</code>. Wenn diese Funktionen mit den
gleichen Argumenten wie zuvor die zugehörigen <code>draw</code>-Operationen aufgerufen
werden, werden die entsprechenden Figuren von der Zeichenfläche
entfernt.
</p>

<p>
Um <b>mehrere Zeichenoperationen hintereinander</b> ausführen zu
können, d. h. <b>mehrere Effekte</b> zu <b>kombininieren</b>, macht man davon
Gebrauch, dass die einzelnen Zeichenoperationen <code>#true</code> als Resultat
liefern. Dadurch ist es möglich mehrere Zeichenoperationen
hintereinander auszuführen, indem man sie in eine Und-Verknüpfung
einschließt:
</p>
<pre class="example">
(and exp1 exp2)
</pre>

<p>
Dieser Ausdruck bewirkt, dass man zuerst den Effekt von <code>exp1</code> und
anschließend den von <code>exp2</code> zu sehen bekommt.
</p>

<p>
Mit <code>(stop)</code> wird die Zeichenfläche geschlossen.
</p>
</div>
</div>

<div id="outline-container-orgea95dc8" class="outline-3">
<h3 id="orgea95dc8"><span class="section-number-3">13.2</span> Aufgabenstellungen</h3>
<div class="outline-text-3" id="text-13-2">
<ol class="org-ol">
<li>Experimentieren Sie mit den o. g. Funktionen.</li>
<li>Kreise und Rechtecke bewegen
<ol class="org-ol">
<li>Entwickeln Sie eine Datenstruktur <code>circle</code> für farbige Kreise. Diese
sollen durch drei Komponenten definiert sein: den Mittelpunkt,
den Radius und die Farbe des Umfangs.</li>
<li>Schreiben Sie die Datendefinition für Kreise und die
Funktionsschablone (gemäß Regeln 7 und 8) für Kreise
verarbeitende Funktionen.</li>
<li>Benutzen Sie die Schablone für die Entwicklung einer Funktion
<code>draw-a-circle</code>. Die Funktion erwartet einen Kreis (<code>circle</code>) als
Argument und zeichnet ihn auf einer Zeichenfläche. Der
Funktionswert sollte <code>#true</code> sein.</li>
<li>Entwickeln Sie eine Funktion <code>translate-circle</code> mit einer
<code>circle</code>-Struktur <code>c</code> und einer <code>posn</code>-Struktur <code>delta</code> als
Parameter. Die Funktion liefert einen <code>circle</code> als Resultat,
dessen Mittelpunkt gegenüber dem von <code>c</code> um den x-Wert von
<code>delta</code> nach rechts und um den y-Wert von <code>delta</code> nach unten
verschoben ist. Die Funktion hat keinen Effekt auf der
Zeichenfläche.</li>
<li>Schreiben Sie eine Funktion <code>clear-a-circle</code>, die einen Kreis
von der Zeichenfläche entfernt.</li>
<li><p>
Schreiben Sie eine Funktion <code>draw-and-clear-circle</code>, die eine
<code>circle</code>-Struktur zeichnet, eine kurze Zeit wartet und sie
anschließend wieder entfernt. Für die Implementierung der
Wartezeit steht die Prozedur <code>sleep-for-a-while</code> zur
Verfügung. Der Aufruf <code>(sleep-for-a-while 3)</code> erzeugt eine
Wartezeit von drei Sekunden. Der Funktionswert ist <code>#true</code>.
</p>

<p>
Die Funktion
</p>
<div class="org-src-container">
<pre class="src src-scheme">          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zeichnet und l&#246;scht einen Kreis a-circle und bewegt ihn um a-posn</span>
           <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">move-circle</span>
             <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-posn a-circle<span style="color: #909183;">]</span>
               <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                 <span style="color: #709870;">[</span><span style="color: #907373;">(</span>draw-and-clear-circle a-circle<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>translate-circle a-circle a-posn<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
                 <span style="color: #709870;">[</span>else a-circle<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
zeichnet und löscht einen Kreis auf der Zeichenfläche und
erzeugt anschließend einen (verschobenen) Kreis, so dass eine
erneute Zeichenoperation den Kreis an einer neuen Position
erscheinen lässt. 
</p>

<p>
Zum Beispiel bewegt der Ausdruck
</p>
<div class="org-src-container">
<pre class="src src-scheme">          <span style="color: #707183;">(</span>draw-a-circle 
           <span style="color: #7388D6;">(</span>move-circle 
            <span style="color: #909183;">(</span>make-posn 10 0<span style="color: #909183;">)</span> 
            <span style="color: #909183;">(</span>move-circle
             <span style="color: #709870;">(</span>make-posn 10 0<span style="color: #709870;">)</span> 
              <span style="color: #709870;">(</span>move-circle 
               <span style="color: #907373;">(</span>make-posn 10 0<span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>make-circle <span style="color: #6276BA;">(</span>make-posn 10 50<span style="color: #6276BA;">)</span> 10 'green<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
einen grünen Kreis dreimal um 10 Pixel nach rechts. Der äußere
Aufruf von <code>draw-a-circle</code> sorgt dafür, dass auch die letzte
Position des Kreises angezeigt wird.
</p>

<p>
Das sei nur ein kleine Anregung für eigene „Animationen“.
</p></li>
</ol></li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">A circle is a structure:</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(make-circle P R C)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">where P is a posn describing the center of the circle,</span>
<span style="color: #8D8D84;">;;       </span><span style="color: #8D8D84; font-style: italic;">R is a number describing the radius of the circle,</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">and C is a color.</span>
<span style="color: #707183;">(</span>define-struct circle <span style="color: #7388D6;">[</span>center radius color<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84; font-style: italic;">#|</span>
<span style="color: #8D8D84; font-style: italic;">;; Funktionsschablone f&#252;r circle-verarbeitende Funktionen</span>

<span style="color: #8D8D84; font-style: italic;">(define fun-for-circles </span>
<span style="color: #8D8D84; font-style: italic;">  (lambda [a-circle]</span>
<span style="color: #8D8D84; font-style: italic;">    ... (circle-center a-circle) ...</span>
<span style="color: #8D8D84; font-style: italic;">    ... (circle-radius a-circle) ...</span>
<span style="color: #8D8D84; font-style: italic;">    ... (circle-color a-circle) ...)(</span>
<span style="color: #8D8D84; font-style: italic;">    |#</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draws the disk on the screen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-a-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>c<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>draw-circle <span style="color: #709870;">(</span>circle-center c<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-radius c<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-color c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES </span>

<span style="color: #707183;">(</span>start 300 300<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-a-circle <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 50 50<span style="color: #909183;">)</span> 50 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">determines if p is inside the circle c.</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'blue<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 6 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'green<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 5.5 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'yellow<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 1 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">in-circle?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>c p<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>&lt;= <span style="color: #709870;">(</span>sqrt <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>sqr <span style="color: #858580;">(</span>- <span style="color: #80A880;">(</span>posn-x <span style="color: #887070;">(</span>circle-center c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                         <span style="color: #80A880;">(</span>posn-x p<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>sqr <span style="color: #858580;">(</span>- <span style="color: #80A880;">(</span>posn-y <span style="color: #887070;">(</span>circle-center c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                         <span style="color: #80A880;">(</span>posn-y p<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
        <span style="color: #709870;">(</span>circle-radius c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to translate a-circle by delta (posn) </span>
<span style="color: #707183;">(</span>check-expect  <span style="color: #7388D6;">(</span>translate-circle
                <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 0 0<span style="color: #709870;">)</span> 5 'blue<span style="color: #909183;">)</span>
                <span style="color: #909183;">(</span>make-posn 10 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
               <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 10 5<span style="color: #909183;">)</span> 5 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">translate-circle</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle delta<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn
                  <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-x delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-x <span style="color: #858580;">(</span>circle-center a-circle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                  <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-y delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-y <span style="color: #858580;">(</span>circle-center a-circle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-radius a-circle<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-color a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to clear a-circle</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">clear-a-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>clear-circle
     <span style="color: #709870;">(</span>circle-center a-circle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>circle-radius a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES</span>
<span style="color: #707183;">(</span>start 100 100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-a-circle <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 50 50<span style="color: #909183;">)</span> 25 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>clear-a-circle <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 50 50<span style="color: #909183;">)</span> 25 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draw-and-clear : circle -&gt; true</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw a circle, wait 1/2 second, and clear it</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-and-clear-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>draw-a-circle a-circle<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>sleep-for-a-while 1/2<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>clear-a-circle a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES</span>
<span style="color: #707183;">(</span>start 100 100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-and-clear-circle <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 50 50<span style="color: #909183;">)</span> 50 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zeichnet und l&#246;scht einen Kreis a-circle und bewegt ihn um a-posn</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">move-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-posn a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>draw-and-clear-circle a-circle<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>translate-circle a-circle a-posn<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else a-circle<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>start 60 100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-a-circle 
 <span style="color: #7388D6;">(</span>move-circle 
  <span style="color: #909183;">(</span>make-posn 10 0<span style="color: #909183;">)</span> 
  <span style="color: #909183;">(</span>move-circle
   <span style="color: #709870;">(</span>make-posn 10 0<span style="color: #709870;">)</span> 
   <span style="color: #709870;">(</span>move-circle 
    <span style="color: #907373;">(</span>make-posn 10 0<span style="color: #907373;">)</span>
    <span style="color: #907373;">(</span>make-circle <span style="color: #6276BA;">(</span>make-posn 10 50<span style="color: #6276BA;">)</span> 10 'green<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org816eca3" class="outline-2">
<h2 id="org816eca3"><span class="section-number-2">14</span> Aufgabe (Datenabstraktion &#x2013; gemischte Daten)</h2>
<div class="outline-text-2" id="text-14">
<p>
Lösen Sie die Aufgabe unter Anwendung der passenden Regeln!
</p>

<p>
Ein <i>Mitarbeiter</i> ist entweder
</p>

<ul class="org-ul">
<li>ein <i>Festangestellter</i> oder</li>
<li>ein <i>Werkstudent</i></li>
</ul>

<p>
Ein <i>Festangestellter</i> wird definiert durch
</p>

<ul class="org-ul">
<li>seinen Namen,</li>
<li>sein Grundgehalt,</li>
<li>die im letzten Monat geleisteten Arbeitsstunden.</li>
</ul>

<p>
Ein <i>Werkstudent</i> wird definiert durch
</p>

<ul class="org-ul">
<li>seinen Namen,</li>
<li>seinen Stundenlohn,</li>
<li>die im letzten Monat geleisteten Arbeitsstunden.</li>
</ul>

<p>
Definieren Sie 
</p>

<ul class="org-ul">
<li>geeignete Datenstrukturen für <i>Mitarbeiter</i>,</li>
<li>eine Funktionsschablone für Funktionen, die <i>Mitarbeiter</i>
verarbeiten.</li>
</ul>

<p>
Entwickeln auf der Grundlage dieser Schablone eine Funktion, die den
Bruttomonatslohn eines Mitarbeiters berechnet. Bei <i>Festangestellten</i>
berechnet sich der Monatslohn aus dem Grundgehalt zuzüglich
Überstundenentgelt. Überstunden sind die über die monatliche
Sollarbeitszeit (die als globale Konstante definiert wird)
hinausgehenden Arbeitsstunden. Der Stundenlohn pro Überstunde berechnet
sich aus dem Grundgehalt und der monatlichen Sollarbeitszeit plus
\(25\%\). Minderstunden bleiben unberücksichtigt.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">Autor der L&#246;sung zu Aufgabe 14: Marlon Tobaben (I16b)</span>

<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">Die Konstante f&#252;r die monatliche sollarbeitszeit eines angestellten</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sollarbeitszeit</span> 120<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein festangestellter ist ein Wert </span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(make-festangestellter name grundgehalt arbeitsstunden)</span>
<span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">wobei der name ein string und</span>
<span style="color: #8D8D84;">;;       </span><span style="color: #8D8D84; font-style: italic;">das grundgehalt und arbeitsstunden Zahlen sind.</span>
<span style="color: #707183;">(</span>define-struct festangestellter <span style="color: #7388D6;">[</span>name grundgehalt arbeitsstunden<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Die Funktion ueberstunden-festangestellter berechnet die &#220;berstunden eines festangestellten</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">anhand der sollarbeitszeit</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>ueberstunden-festangestellter 120<span style="color: #7388D6;">)</span>  0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>ueberstunden-festangestellter 130<span style="color: #7388D6;">)</span> 10<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>ueberstunden-festangestellter 150<span style="color: #7388D6;">)</span> 30<span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">ueberstunden-festangestellter</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>arbeitsstunden<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&gt; <span style="color: #6276BA;">(</span>- arbeitsstunden sollarbeitszeit<span style="color: #6276BA;">)</span> 0<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>- arbeitsstunden sollarbeitszeit<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span>else 0<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Funktion bruttolohn-festangesteller berechnet den Bruttolohn eines Festanstellten unter Ber&#252;cksichtung</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">der sollarbeitszeit und mit 25% zuschlag bei ueberstunden</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-festangestellter <span style="color: #909183;">(</span>make-festangestellter <span style="color: #008000;">"Peter"</span> 3000 120<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  3000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-festangestellter <span style="color: #909183;">(</span>make-festangestellter <span style="color: #008000;">"Heinz"</span> 3000   0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  3000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-festangestellter <span style="color: #909183;">(</span>make-festangestellter <span style="color: #008000;">"Heinz"</span> 3000 240<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  6750<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bruttolohn-festangestellter</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>f<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>festangestellter-grundgehalt f<span style="color: #709870;">)</span> 
       <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>ueberstunden-festangestellter <span style="color: #6276BA;">(</span>festangestellter-arbeitsstunden f<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
          <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>/ <span style="color: #858580;">(</span>festangestellter-grundgehalt f<span style="color: #858580;">)</span> sollarbeitszeit<span style="color: #6276BA;">)</span> 1.25<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein werksstudent ist ein Wert </span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(make-werksstudent name stundenlohn arbeitsstunden)</span>
<span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">wobei der name ein string und</span>
<span style="color: #8D8D84;">;;       </span><span style="color: #8D8D84; font-style: italic;">das stundenlohn  und arbeitsstunden Zahlen sind.</span>
<span style="color: #707183;">(</span>define-struct werksstudent <span style="color: #7388D6;">[</span>name stundenlohn arbeitsstunden<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Funktion bruttolohn-werkstundent berechnet den Bruttolohn eines werksstundenten</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-werksstudent <span style="color: #909183;">(</span>make-werksstudent <span style="color: #008000;">"Peter"</span> 10 120<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  1200<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-werksstudent <span style="color: #909183;">(</span>make-werksstudent <span style="color: #008000;">"Heinz"</span>  0  20<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>     0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-werksstudent <span style="color: #909183;">(</span>make-werksstudent <span style="color: #008000;">"Heinz"</span> 20 120<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  2400<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bruttolohn-werksstudent</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>w<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span>werksstudent-stundenlohn w<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>werksstudent-arbeitsstunden w<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein mitarbeiter ist entweder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- ein festangestellter</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- ein werksstudent</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">name: mitarbeiter</span>

<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">Funktion bruttolohn-mitarbeiter berechnet den bruttolohn eines mitarbeiters</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-mitarbeiter <span style="color: #909183;">(</span>make-werksstudent <span style="color: #008000;">"Heinz"</span>  0  20<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>bruttolohn-mitarbeiter <span style="color: #909183;">(</span>make-festangestellter <span style="color: #008000;">"Heinz"</span> 3000  0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 3000<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">bruttolohn-mitarbeiter</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>mitarbeiter<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>festangestellter? mitarbeiter<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>bruttolohn-festangestellter mitarbeiter<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span><span style="color: #907373;">(</span>werksstudent?     mitarbeiter<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>bruttolohn-werksstudent     mitarbeiter<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org84a3379" class="outline-2">
<h2 id="org84a3379"><span class="section-number-2">15</span> Aufgabe (Datenabstraktion &#x2013; gemischte Daten &#x2013; Zusatzaufgabe)</h2>
<div class="outline-text-2" id="text-15">
</div>
<div id="outline-container-org33eb8c0" class="outline-3">
<h3 id="org33eb8c0"><span class="section-number-3">15.1</span> Vorbemerkung</h3>
<div class="outline-text-3" id="text-15-1">
<p>
Diese Aufgabe stellt eine Fortführung von Aufgabe 13 dar. Falls Sie
diese noch nicht bearbeitet haben, sollten Sie zunächst damit beginnen.
</p>
</div>
</div>
<div id="outline-container-orgb8977bf" class="outline-3">
<h3 id="orgb8977bf"><span class="section-number-3">15.2</span> Aufgabenstellungen</h3>
<div class="outline-text-3" id="text-15-2">
<ol class="org-ol">
<li>Enwtickeln Sie eine Datenstrukturdefinition für farbige
Rechtecke. Ein Rechteck sei durch einen Punkt (<code>posn</code>-Struktur),
der die linke obere Ecke des Rechtecks bildet, zwei Zahlen für die
Höhe und die Breite des Rechecks und ein Symbol für seine Farbe
charakterisiert.</li>
<li>Entwickeln sie die folgenden Funktionen
<dl class="org-dl">
<dt><code>draw-a-rectangle</code></dt><dd>zeichnet das Rechteck auf die Zeichenfläche. Im
Gegensatz zu den Kreisen aus Aufgabe 13 sollen die Rechtecke immer
mit der Farbe gefüllt gezeichnet werden.</dd>
<dt><code>in-rectangle?</code></dt><dd>akzeptiert ein Rechteck und einen Punkt als
Argumente und prüft, ob der Punkt innerhalb des Rechecks liegt.</dd>
<dt><code>translate-rectangle</code></dt><dd>verschiebt ein Rechteck auf die gleiche
Art, wie es die Funktion <code>translate-circle</code> aus Aufgabe 13 mit
Kreisen tut. Diese Funktion hat keinen Effekt auf der
Zeichenfläche.</dd>
<dt><code>clear-a-rectangle</code></dt><dd>entfernt ein Rechteck von der Zeichenfläche.</dd>
<dt><code>move-rectangle</code></dt><dd>soll analog zur Funktion <code>move-circle</code> aus
Aufgabe 13 ein Rechteck zeichnen, löschen und mit einem
verschobenen Rechteck antworten.</dd>
</dl></li>
<li>Definieren Sie eine gemischte Datenstruktur für Figuren (shapes),
die als Generalisierung mindestens Kreise und Rechtecke umfassen
sollte. Schreiben Sie die Funktionsschablone für Funktionen, die
Figuren verarbeiten, auf.</li>
<li>Programmieren Sie nun die oben genannten Funktionen für Figuren
(z. B. <code>draw-a-shape</code>)</li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">a shape is either:</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">- a circle</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">- a rectangle</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">A circle is a structure:</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(make-circle P R C)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">where P is a posn describing the center of the circle,</span>
<span style="color: #8D8D84;">;;       </span><span style="color: #8D8D84; font-style: italic;">R is a number describing the radius of the circle,</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">and C is a color.</span>
<span style="color: #707183;">(</span>define-struct circle <span style="color: #7388D6;">(</span>center radius color<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draws the disk on the screen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-a-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>c<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>draw-circle <span style="color: #709870;">(</span>circle-center c<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-radius c<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-color c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">determines if p is inside the circle c.</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'blue<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 6 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'green<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 5.5 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-circle? <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 6 5<span style="color: #709870;">)</span> 1 'yellow<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 1 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">in-circle?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>c p<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>&lt;= <span style="color: #709870;">(</span>sqrt <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>sqr <span style="color: #858580;">(</span>- <span style="color: #80A880;">(</span>posn-x <span style="color: #887070;">(</span>circle-center c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                         <span style="color: #80A880;">(</span>posn-x p<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>sqr <span style="color: #858580;">(</span>- <span style="color: #80A880;">(</span>posn-y <span style="color: #887070;">(</span>circle-center c<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                         <span style="color: #80A880;">(</span>posn-y p<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
        <span style="color: #709870;">(</span>circle-radius c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to translate a-circle by delta (posn) </span>
<span style="color: #707183;">(</span>check-expect  <span style="color: #7388D6;">(</span>translate-circle
                <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 0 0<span style="color: #709870;">)</span> 5 'blue<span style="color: #909183;">)</span>
                <span style="color: #909183;">(</span>make-posn 10 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
               <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 10 5<span style="color: #909183;">)</span> 5 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">translate-circle</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle delta<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn
                  <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-x delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-x <span style="color: #858580;">(</span>circle-center a-circle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                  <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-y delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-y <span style="color: #858580;">(</span>circle-center a-circle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-radius a-circle<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>circle-color a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to clear a-circle</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">clear-a-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>clear-circle
     <span style="color: #709870;">(</span>circle-center a-circle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>circle-radius a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draw-and-clear : circle -&gt; true</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw a circle, wait 1/2 second, and clear it</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-and-clear-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>draw-a-circle a-circle<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>sleep-for-a-while 1/2<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>clear-a-circle a-circle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw, to clear, and to move a-circle by a-posn</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">move-circle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-posn a-circle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>draw-and-clear-circle a-circle<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>translate-circle a-circle a-posn<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else a-circle<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">A rectangle is a structure:</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(make-rectangle P W H)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">where P is a posn, W is a number and H is a number.</span>
<span style="color: #707183;">(</span>define-struct rectangle <span style="color: #7388D6;">(</span>nw-corner width height color<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">DATA EXAMPLES</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">example-rectangle1</span> <span style="color: #7388D6;">(</span>make-rectangle <span style="color: #909183;">(</span>make-posn 20 20<span style="color: #909183;">)</span> 260 260 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">example-rectangle2</span> <span style="color: #7388D6;">(</span>make-rectangle <span style="color: #909183;">(</span>make-posn 60 60<span style="color: #909183;">)</span> 180 180 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw a-rect</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-a-rectangle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-rectangle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>draw-solid-rect
     <span style="color: #709870;">(</span>rectangle-nw-corner a-rectangle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>rectangle-width a-rectangle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>rectangle-height a-rectangle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>rectangle-color a-rectangle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to determine if a-posn is in a-rectangle, or not</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-rectangle? example-rectangle1 <span style="color: #909183;">(</span>make-posn 0 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-rectangle? example-rectangle1 <span style="color: #909183;">(</span>make-posn 25 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-rectangle? example-rectangle1 <span style="color: #909183;">(</span>make-posn 0 25<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>in-rectangle? example-rectangle1 <span style="color: #909183;">(</span>make-posn 25 25<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">in-rectangle?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-rectangle a-posn<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>&lt;= <span style="color: #907373;">(</span>posn-x <span style="color: #6276BA;">(</span>rectangle-nw-corner a-rectangle<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>posn-x a-posn<span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-x <span style="color: #858580;">(</span>rectangle-nw-corner a-rectangle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                <span style="color: #6276BA;">(</span>rectangle-width a-rectangle<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>&lt;= <span style="color: #907373;">(</span>posn-y <span style="color: #6276BA;">(</span>rectangle-nw-corner a-rectangle<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>posn-y a-posn<span style="color: #907373;">)</span>
             <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-y <span style="color: #858580;">(</span>rectangle-nw-corner a-rectangle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                <span style="color: #6276BA;">(</span>rectangle-height a-rectangle<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to translate a-rectangle by delta (posn) </span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>translate-rectangle example-rectangle1 <span style="color: #909183;">(</span>make-posn 30 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>make-rectangle <span style="color: #909183;">(</span>make-posn 50 20<span style="color: #909183;">)</span> 260 260 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">translate-rectangle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-rectangle delta<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>make-rectangle <span style="color: #709870;">(</span>make-posn
                     <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-x delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-x <span style="color: #858580;">(</span>rectangle-nw-corner a-rectangle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                     <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>posn-y delta<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>posn-y <span style="color: #858580;">(</span>rectangle-nw-corner a-rectangle<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                    <span style="color: #709870;">(</span>rectangle-width a-rectangle<span style="color: #709870;">)</span>
                    <span style="color: #709870;">(</span>rectangle-height a-rectangle<span style="color: #709870;">)</span>
                    <span style="color: #709870;">(</span>rectangle-color a-rectangle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to erase a rectangle</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">clear-a-rectangle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-rectangle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>clear-solid-rect 
     <span style="color: #709870;">(</span>rectangle-nw-corner a-rectangle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>rectangle-width a-rectangle<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>rectangle-height a-rectangle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw a circle, wait 1/2 second, and clear it</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-and-clear-rectangle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-rectangle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>draw-a-rectangle a-rectangle<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>sleep-for-a-while 1/2<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>clear-a-rectangle a-rectangle<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">to draw and clear a rectangle, translate it by delta pixels</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">move-rectangle</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>delta a-rectangle<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>draw-and-clear-rectangle a-rectangle<span style="color: #907373;">)</span> 
       <span style="color: #907373;">(</span>translate-rectangle a-rectangle delta<span style="color: #907373;">)</span><span style="color: #709870;">]</span> 
      <span style="color: #709870;">[</span>else a-rectangle<span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;;;;;;;;</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draws a-shape</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">draw-shape</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-shape<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>circle? a-shape<span style="color: #907373;">)</span> 
       <span style="color: #907373;">(</span>draw-a-circle a-shape<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>rectangle? a-shape<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>draw-a-rectangle a-shape<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES AS TESTS</span>
<span style="color: #707183;">(</span>start 200 200<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-shape <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 30 30<span style="color: #909183;">)</span> 20 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> 
<span style="color: #707183;">(</span>draw-shape <span style="color: #7388D6;">(</span>make-rectangle  <span style="color: #909183;">(</span>make-posn 30 60<span style="color: #909183;">)</span> 20 50 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">-------------------------------------------------------------------------</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">translates a-shape by delta (posn)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>translate-shape <span style="color: #909183;">(</span>make-circle <span style="color: #709870;">(</span>make-posn 30 30<span style="color: #709870;">)</span> 20 'red<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 10 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>  
              <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 40 30<span style="color: #909183;">)</span> 20 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>translate-shape <span style="color: #909183;">(</span>make-rectangle <span style="color: #709870;">(</span>make-posn 30 60<span style="color: #709870;">)</span> 20 50 'blue<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>make-posn 20 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>make-rectangle  <span style="color: #909183;">(</span>make-posn 50 60<span style="color: #909183;">)</span> 20 50 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">translate-shape</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-shape delta<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>circle? a-shape<span style="color: #907373;">)</span> 
       <span style="color: #907373;">(</span>translate-circle a-shape delta<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>rectangle? a-shape<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>translate-rectangle a-shape delta<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">erases a-shape</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">no tests, because function always returns true</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">clear-shape</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-shape<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>circle? a-shape<span style="color: #907373;">)</span> 
       <span style="color: #907373;">(</span>draw-a-circle a-shape<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>rectangle? a-shape<span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>draw-a-rectangle a-shape<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES </span>
<span style="color: #707183;">(</span>start 200 200<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-shape <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 30 30<span style="color: #909183;">)</span> 20 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>draw-shape <span style="color: #7388D6;">(</span>make-rectangle  <span style="color: #909183;">(</span>make-posn 30 60<span style="color: #909183;">)</span> 20 50 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>clear-shape <span style="color: #7388D6;">(</span>make-circle <span style="color: #909183;">(</span>make-posn 30 30<span style="color: #909183;">)</span> 20 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> 
<span style="color: #707183;">(</span>clear-shape <span style="color: #7388D6;">(</span>make-rectangle <span style="color: #909183;">(</span>make-posn 30 60<span style="color: #909183;">)</span> 20 50 'blue<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">-------------------------------------------------------------------------</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">draws a-shape, waits one second, clears a-shape,</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">returns a-shape translated by delta pixels.</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">move-shape</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>a-shape delta<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>draw-shape a-shape<span style="color: #6276BA;">)</span>
            <span style="color: #6276BA;">(</span>sleep-for-a-while 1<span style="color: #6276BA;">)</span>
            <span style="color: #6276BA;">(</span>clear-shape a-shape<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>translate-shape a-shape delta<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else 
       <span style="color: #907373;">(</span>translate-shape a-shape delta<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">EXAMPLES AS TESTS</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">my-shape</span> <span style="color: #7388D6;">(</span>make-circle  <span style="color: #909183;">(</span>make-posn 30 30<span style="color: #909183;">)</span> 20 'red<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>start 100 100<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>move-shape
 <span style="color: #7388D6;">(</span>move-shape
  <span style="color: #909183;">(</span>move-shape
   <span style="color: #709870;">(</span>move-shape my-shape <span style="color: #907373;">(</span>make-posn 10 0<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>make-posn 10 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>make-posn 10 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
 <span style="color: #7388D6;">(</span>make-posn 10 0<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #008000;">"should be"</span>
<span style="color: #707183;">(</span>make-circle <span style="color: #7388D6;">(</span>make-posn 70 30<span style="color: #7388D6;">)</span> 20 'red<span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdb21ab7" class="outline-2">
<h2 id="listenkonstruktion"><span class="section-number-2">16</span> Aufgabe (Listenkonstruktion und -zerlegung)</h2>
<div class="outline-text-2" id="text-listenkonstruktion">
<p>
Werten Sie die folgenden Funktionsaufrufe aus:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Nr.</th>
<th scope="col" class="org-left">Ausdruck</th>
<th scope="col" class="org-left">Lösung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">a)</td>
<td class="org-left"><code>(first '((A) B C D))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">b)</td>
<td class="org-left"><code>(rest '((A)(B C D)))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">c)</td>
<td class="org-left"><code>(cons '(A B) '(A B))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">d)</td>
<td class="org-left"><code>(cons 'A '())</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">e)</td>
<td class="org-left"><code>(first '(((A))))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">f)</td>
<td class="org-left"><code>(rest '(((A))))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">g)</td>
<td class="org-left"><code>(cons '((A)) empty)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">h)</td>
<td class="org-left"><code>(equal? 'X1 'X2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">i)</td>
<td class="org-left"><code>(equal? '(X1) 'X2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">j)</td>
<td class="org-left"><code>(equal? '(X1) '(X2))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">k)</td>
<td class="org-left"><code>(list? 'X1)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">l)</td>
<td class="org-left"><code>(list? '(X1))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">m)</td>
<td class="org-left"><code>(empty? '())</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">n)</td>
<td class="org-left"><code>(empty? '(()))</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Nr.</th>
<th scope="col" class="org-left">Ausdruck</th>
<th scope="col" class="org-left">Lösung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">a)</td>
<td class="org-left"><code>(first '((A) B C D))</code></td>
<td class="org-left">(A)</td>
</tr>

<tr>
<td class="org-left">b)</td>
<td class="org-left"><code>(rest '((A)(B C D)))</code></td>
<td class="org-left">((B C D))</td>
</tr>

<tr>
<td class="org-left">c)</td>
<td class="org-left"><code>(cons '(A B) '(A B))</code></td>
<td class="org-left">((A B) A B)</td>
</tr>

<tr>
<td class="org-left">d)</td>
<td class="org-left"><code>(cons 'A '())</code></td>
<td class="org-left">(A)</td>
</tr>

<tr>
<td class="org-left">e)</td>
<td class="org-left"><code>(first '(((A))))</code></td>
<td class="org-left">((A))</td>
</tr>

<tr>
<td class="org-left">f)</td>
<td class="org-left"><code>(rest '(((A))))</code></td>
<td class="org-left">()</td>
</tr>

<tr>
<td class="org-left">g)</td>
<td class="org-left"><code>(cons '((A)) empty)</code></td>
<td class="org-left">(((A)))</td>
</tr>

<tr>
<td class="org-left">h)</td>
<td class="org-left"><code>(equal? 'X1 'X2)</code></td>
<td class="org-left">#false</td>
</tr>

<tr>
<td class="org-left">i)</td>
<td class="org-left"><code>(equal? '(X1) 'X2)</code></td>
<td class="org-left">#false</td>
</tr>

<tr>
<td class="org-left">j)</td>
<td class="org-left"><code>(equal? '(X1) '(X2))</code></td>
<td class="org-left">#false</td>
</tr>

<tr>
<td class="org-left">k)</td>
<td class="org-left"><code>(list? 'X1)</code></td>
<td class="org-left">#false</td>
</tr>

<tr>
<td class="org-left">l)</td>
<td class="org-left"><code>(list? '(X1))</code></td>
<td class="org-left">#true</td>
</tr>

<tr>
<td class="org-left">m)</td>
<td class="org-left"><code>(empty? '())</code></td>
<td class="org-left">#true</td>
</tr>

<tr>
<td class="org-left">n)</td>
<td class="org-left"><code>(empty? '(()))</code></td>
<td class="org-left">#false</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgbf428a6" class="outline-2">
<h2 id="orgbf428a6"><span class="section-number-2">17</span> Aufgabe (Listenverarbeitung)</h2>
<div class="outline-text-2" id="text-17">
<ol class="org-ol">
<li><p>
Die Funktion <code>enthaelt?</code> beantworte, angewendet auf ein Symbol und
eine Liste von Symbolen, die Frage, ob das Symbol in der Liste
enthalten ist oder nicht
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">enthaelt? ; (list-of symbol) symbol -&gt; boolean</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>enthaelt? empty 's<span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>enthaelt? '<span style="color: #909183;">(</span>x y z<span style="color: #909183;">)</span> 's<span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>enthaelt? '<span style="color: #909183;">(</span>s y z<span style="color: #909183;">)</span> 's<span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>enthaelt? '<span style="color: #909183;">(</span>x y s z<span style="color: #909183;">)</span> 's<span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
   
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">enthaelt?</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>liste symbol<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? liste<span style="color: #907373;">)</span> #false<span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>equal? <span style="color: #6276BA;">(</span>first liste<span style="color: #6276BA;">)</span> symbol<span style="color: #907373;">)</span> #true<span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>enthaelt? <span style="color: #6276BA;">(</span>rest liste<span style="color: #6276BA;">)</span> symbol<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Die Funktion <code>sum</code> liefere, angewendet auf eine Liste von Zahlen <code>x</code>,
die Summe der Elemente.
</p>
<p>
Die folgende Lösung erlaubt nur nicht leere Listen von Zahlen:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition:</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n empty), wobei n eine Zahl ist oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n lvz), wobei n eine Zahl und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum : (list-of number) -&gt; number</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">(</span>1 2 3 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 10<span style="color: #707183;">)</span>
        
        <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sum</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? <span style="color: #6276BA;">(</span>rest lvz<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>first lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>sum <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
Die folgende Lösung liefert für leere Listen das neutrale Element
bzgl. der Addition:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition:</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- enpty</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n lvz), wobei n eine Zahl und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum : (list-of number) -&gt; number</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">(</span>1 2 3 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 10<span style="color: #707183;">)</span>
        
        <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sum</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? lvz<span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>sum <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Die Funktion <code>prod</code> liefere, angewendet auf eine Liste von Zahlen
<code>x</code>, das Produkt der Elemente.
</p>
<p>
Die folgende Lösung erlaubt nur nicht leere Listen von Zahlen:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition:</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n empty), wobei n eine Zahl ist oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n lvz), wobei n eine Zahl und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum : (list-of number) -&gt; number</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod '<span style="color: #909183;">(</span>1 2 3 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 24<span style="color: #707183;">)</span>
        
        <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">prod</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? <span style="color: #6276BA;">(</span>rest lvz<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>first lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>prod <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
Die folgende Lösung liefert für leere Listen das neutrale Element
bzgl. der Multiplikation:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition:</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- enpty</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n lvz), wobei n eine Zahl und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum : (list-of number) -&gt; number</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod '<span style="color: #909183;">(</span>1 2 3 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 24<span style="color: #707183;">)</span>
        
        <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">prod</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? lvz<span style="color: #907373;">)</span> 1<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>prod <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Die Funktion <code>maximum</code> liefere, angewendet auf eine Liste von Zahlen
<code>x</code>, das Maximum der Elemente.
</p>
<p>
Die folgende Lösung erlaubt nur nicht leere Listen von Zahlen:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition:</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n empty), wobei n eine Zahl ist oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">- (cons n lvz), wobei n eine Zahl und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum : (list-of number) -&gt; number</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>maximum '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>maximum '<span style="color: #909183;">(</span>1 2 3 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 3<span style="color: #707183;">)</span>
        
        <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">maximum</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? <span style="color: #6276BA;">(</span>rest lvz<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>first lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>max <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>maximum <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Schreiben Sie eine Funktion <code>(declist x)</code>, die aus einer Liste <code>x</code>
von Zahlen eine neue Liste berechnet, deren Elemente um 1 kleiner
sind, als die der ursprünglichen Liste:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(declist x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(2 5 7)</td>
<td class="org-left">(1 4 6)</td>
</tr>

<tr>
<td class="org-left">()</td>
<td class="org-left">()</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">declist : (list-of number) -&gt; (list-of number)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>declist empty<span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>declist '<span style="color: #909183;">(</span>2 5 7<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1 4 6<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">declist</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? lvz<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
                 <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>- <span style="color: #858580;">(</span>first lvz<span style="color: #858580;">)</span> 1<span style="color: #6276BA;">)</span> 
                             <span style="color: #6276BA;">(</span>declist <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
           <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Definieren Sie eine Funktion <code>(flatten x)</code>, die als Argument eine
Liste <code>x</code> mit beliebig tief geschachtelten Unterlisten hat und als
Ergebnis eine Liste von Atomen liefern soll mit der Eigenschaft, dass
alle Atome, die in x vorkommen auch in <code>(flatten x)</code> in derselben
Reihenfolge vorkommen:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(flatten x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(A (B C) D)</td>
<td class="org-left">(A B C D)</td>
</tr>

<tr>
<td class="org-left">(((A B) C)(D E))</td>
<td class="org-left">(A B C D E)</td>
</tr>

<tr>
<td class="org-left">((((A))))</td>
<td class="org-left">(A)</td>
</tr>
</tbody>
</table>

<p>
<b>Hinweis:</b> Definieren Sie zuerst in der bekannten Art und Weise
eine rekursive Datenstruktur für geschachtelte Listen. Leiten Sie
daraus eine passende <b>Funktionsschablone</b> ab.
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Definition einer beliebig tief geschachtelten Liste (btgl) von Atomen</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine btgl ist</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- empty</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist ein Atom, l ist eine btgl</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons l1 l2) mit l1, l2 sind btgl</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Funktionsschablone:</span>
   <span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">(define f</span>
   <span style="color: #8D8D84;">;  </span><span style="color: #8D8D84; font-style: italic;">(lambda [l]</span>
   <span style="color: #8D8D84;">;    </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
   <span style="color: #8D8D84;">;      </span><span style="color: #8D8D84; font-style: italic;">[(empty? l) ...]</span>
   <span style="color: #8D8D84;">;      </span><span style="color: #8D8D84; font-style: italic;">[(not (list? (first l)))</span>
   <span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">... (first l) ... (f (rest l)) ...]</span>
   <span style="color: #8D8D84;">;      </span><span style="color: #8D8D84; font-style: italic;">[else  ... (f (first l)) ... (f (rest l)) ...])))</span>
   <span style="color: #8D8D84;">;;</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">flatten : (list-of any) -&gt; (list-of atom)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>flatten empty<span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>flatten '<span style="color: #909183;">(</span>a <span style="color: #709870;">(</span>b <span style="color: #907373;">(</span>c <span style="color: #6276BA;">(</span>d<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>a b c d<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>flatten '<span style="color: #909183;">(</span><span style="color: #709870;">(</span><span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>a<span style="color: #6276BA;">)</span> b<span style="color: #907373;">)</span> c<span style="color: #709870;">)</span> d<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>a b c d<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">flatten</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>l<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>not <span style="color: #6276BA;">(</span>list? <span style="color: #858580;">(</span>first l<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
          <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first l<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>flatten <span style="color: #858580;">(</span>rest l<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span>else  <span style="color: #907373;">(</span>append <span style="color: #6276BA;">(</span>flatten <span style="color: #858580;">(</span>first l<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>flatten <span style="color: #858580;">(</span>rest l<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">;; Konkatiniert die zwei Listen l1 und l2 </span>
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">;; append : (list-of any) (list-of any) -&gt; (list-of any)</span>
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(check-expect (append empty empty) empty)</span>
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(check-expect (append empty '(A B C)) '(A B C))</span>
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(check-expect (append '(A B C) empty) '(A B C))</span>
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(check-expect (append '(A B C) '(C D E)) '(A B C C D E))</span>
        
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(define append</span>
        <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">(lambda [l1 l2]</span>
        <span style="color: #8D8D84;">;;     </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
        <span style="color: #8D8D84;">;;        </span><span style="color: #8D8D84; font-style: italic;">[(empty? l1) l2]</span>
        <span style="color: #8D8D84;">;;        </span><span style="color: #8D8D84; font-style: italic;">[(empty? l2) l1]</span>
        <span style="color: #8D8D84;">;;        </span><span style="color: #8D8D84; font-style: italic;">[else (cons (first l1) (append (rest l1) l2))])))</span>
</pre>
</div></li>
<li><p>
Schreiben Sie eine Funktion <code>(frequencies x)</code>, die aus einer Liste
<code>x</code> von Atomen eine Liste von zwei-elementigen Listen erzeugt: Dabei
ist das erste Element das Atom aus <code>x</code>, das zweite Element die
Häufigkeit des Auftretens in <code>x</code>. Die Reihenfolge der Strukturen in
der Ergebnisliste ist belanglos.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(frequencies x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(A B A B A C A)</td>
<td class="org-left">((A 4) (B 2) (C 1))</td>
</tr>

<tr>
<td class="org-left">()</td>
<td class="org-left">()</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datenstrukturdefinitionen:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Atom-Number-Pair (anp) ist ein</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a (cons n empty)) mit a ist Atom und n ist Number</span>
<span style="color: #8D8D84;">;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste von Atomen (loa) ist </span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- empty oder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist Atom und l ist loa</span>
<span style="color: #8D8D84;">;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste von Atom-Number-Pairs (loanp) ist</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- empty oder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist anp und l ist loanp</span>
   
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">erhoeht die number im ersten atom-mumber-pair um 1</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">incr-first-number : (list-of atom-number-pair) </span>
<span style="color: #8D8D84;">;;                      </span><span style="color: #8D8D84; font-style: italic;">-&gt; (list-of atom-number-pair)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>incr-first-number '<span style="color: #909183;">(</span><span style="color: #709870;">(</span>a  5<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>b  3<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>c  4<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 
              '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>a  6<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>b  3<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>c  4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">incr-first-number</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>aloanp<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>firstatom <span style="color: #6276BA;">(</span>first <span style="color: #858580;">(</span>first aloanp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>firstnumber <span style="color: #6276BA;">(</span>first <span style="color: #858580;">(</span>rest <span style="color: #80A880;">(</span>first aloanp<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>rest-anps <span style="color: #6276BA;">(</span>rest aloanp<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>cons <span style="color: #907373;">(</span>list firstatom <span style="color: #6276BA;">(</span>+ 1 firstnumber<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> rest-anps<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;;; </span><span style="color: #8D8D84; font-style: italic;">Version von incr-first-number ohne lokale Definitionen</span>
<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">(define incr-first-number </span>
<span style="color: #8D8D84;">;  </span><span style="color: #8D8D84; font-style: italic;">(lambda [aloanp]</span>
<span style="color: #8D8D84;">;    </span><span style="color: #8D8D84; font-style: italic;">(cons (list (first (first aloanp)) (+ 1 (first (rest (first aloanp))))) (rest aloanp))))</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob das Atom in der Liste vorkommt:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- falls ja ist die number im entsprechenden pair zu inkrementieren</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- falls nein ist der Liste ein neues pair "(atom  1)" hinzuzufuegen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add-atom : atom (list-of atom-number-pair) </span>
<span style="color: #8D8D84;">;;                 </span><span style="color: #8D8D84; font-style: italic;">-&gt; (list-of atom-number-pair)))</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add-atom 'a empty<span style="color: #7388D6;">)</span>  '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>a  1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add-atom 'a '<span style="color: #909183;">(</span><span style="color: #709870;">(</span>a  1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>b  1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>a  2<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>b  1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add-atom 'a '<span style="color: #909183;">(</span><span style="color: #709870;">(</span>b  1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>b  1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>a  1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">add-atom</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>atom aloanp<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? aloanp<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>list atom 1<span style="color: #6276BA;">)</span> empty<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>equal? atom <span style="color: #6276BA;">(</span>first <span style="color: #858580;">(</span>first aloanp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
       <span style="color: #907373;">(</span>incr-first-number aloanp<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first aloanp<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>add-atom atom <span style="color: #858580;">(</span>rest aloanp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenblatt</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">frequencies : (list-of atom) -&gt;  (list-of atom-number-pair)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>frequencies empty<span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span> 
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>frequencies '<span style="color: #909183;">(</span>a<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>a  1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>frequencies '<span style="color: #909183;">(</span>A B A B A C A<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>A  4<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>C  1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>B  2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">frequencies</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>aloa<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? aloa<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else
       <span style="color: #907373;">(</span>add-atom <span style="color: #6276BA;">(</span>first aloa<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>frequencies <span style="color: #858580;">(</span>rest aloa<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>   
</pre>
</div></li>
<li><p>
Schreiben Sie eine Funktion <code>anzahl-bevor-summe-erreicht</code>, die eine
positive ganze Zahl, genannt <code>summe</code> und eine Liste von positiven
ganzen Zahlen, genannt <code>lvz</code> als Argumente akzeptiert. Sie gibt
eine ganze Zahl \(n\) zurück, so dass die Summe der ersten \(n\)
Elemente von <code>lvz</code> kleiner als <code>sum</code>,  die Summe der ersten \(n+1\)
Elemente hingegen größer oder gleich <code>sum</code> ist. Es ist ein Fehler,
wenn die Summe der Elemente der Liste insgesamt kleiner als sum
ist.<br />
Beispiele:<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">sum</th>
<th scope="col" class="org-left">lvz</th>
<th scope="col" class="org-right">(anzahl-bevor-summe-erreicht sum lvz)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">2</td>
<td class="org-left">(2 5 7)</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">(2 5 7)</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-left">(2 5 7)</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">(2 5 7)</td>
<td class="org-right">Fehler</td>
</tr>
</tbody>
</table>

<p>
<b>Hinweise:</b> 
</p>
<ol class="org-ol">
<li><p>
Für den Fehlerfall darf die Standardfunktion <code>error</code>
benutzt werden. Sie erwartet zwei Argumente, ein Symbol und eine
Zeichenkette und könnte z. B. so benutzt werden:
</p>
<pre class="example">
(error 'anzahl-bevor-summe-erreicht "Summe der Listenelemente zu klein")
</pre></li>
<li>Lösen Sie die Aufgabe, ohne die Summe der Listenelemente zu berechnen.</li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>anzahl-bevor-summe-erreicht 2 '<span style="color: #909183;">(</span>2 5 7<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>anzahl-bevor-summe-erreicht 4 '<span style="color: #909183;">(</span>2 5 7<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>anzahl-bevor-summe-erreicht 8 '<span style="color: #909183;">(</span>2 5 7<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 2<span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-error <span style="color: #7388D6;">(</span>anzahl-bevor-summe-erreicht 15 '<span style="color: #909183;">(</span>2 5 7<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #008000;">"anzahl-bevor-summe-erreicht: Summe der Listenelemente zu klein"</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">anzahl-bevor-summe-erreicht</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>sum lvz<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? lvz<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>error 'anzahl-bevor-summe-erreicht <span style="color: #008000;">"Summe der Listenelemente zu klein"</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&lt;= sum <span style="color: #6276BA;">(</span>first lvz<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
         <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ 1 <span style="color: #6276BA;">(</span>anzahl-bevor-summe-erreicht
                     <span style="color: #858580;">(</span>- sum <span style="color: #80A880;">(</span>first lvz<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                     <span style="color: #858580;">(</span>rest lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org0aff39c" class="outline-2">
<h2 id="org0aff39c"><span class="section-number-2">18</span> Aufgabe (Funktionen über zwei Listen)</h2>
<div class="outline-text-2" id="text-18">
<p>
Die in den folgenden Aufgaben zu entwickelnden Funktionen haben alle 2
Listen-Parameter. Lösen Sie diese Aufgaben unter Anwendung der Regeln
11 bis 13. Überlegen Sie dabei, ob für die Erstellung der
Funktionsschablone der Zugriff auf das erste Element und die Restliste
hinsichtlich des ersten, des zweiten oder beider Parameter vorgenommen
werden muss.
</p>

<ol class="org-ol">
<li><p>
Schreiben Sie ein Funktion <code>concatenate</code>, die zwei Listen von
Symbolen aneinander hängt. Beispiel:
</p>
<pre class="example">
(concatenate ’(a b c) ’(d e f)) =&gt; ’(a b c d e f)
</pre>

<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Symbolen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">1. empty oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">2. (cons s lvs), wobei s ein Symbol </span>
   <span style="color: #8D8D84;">;;                   </span><span style="color: #8D8D84; font-style: italic;">und lvs eine Liste-von-Symbolen ist</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">concatenate : (list-of symbol) (list-of symbol) -&gt; (list-of symbol)</span>

   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>concatenate &#8217;<span style="color: #909183;">(</span>a b c<span style="color: #909183;">)</span> &#8217;<span style="color: #909183;">(</span>d e f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> &#8217;<span style="color: #7388D6;">(</span>a b c d e f<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>concatenate &#8217;<span style="color: #909183;">()</span> &#8217;<span style="color: #909183;">(</span>d e f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> &#8217;<span style="color: #7388D6;">(</span>d e f<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>concatenate &#8217;<span style="color: #909183;">(</span>a b c<span style="color: #909183;">)</span> &#8217;<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> &#8217;<span style="color: #7388D6;">(</span>a b c<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">concatenate</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>l1 l2<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l1<span style="color: #907373;">)</span> l2<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l2<span style="color: #907373;">)</span> l1<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first l1<span style="color: #6276BA;">)</span>
                              <span style="color: #6276BA;">(</span>concatenate <span style="color: #858580;">(</span>rest l1<span style="color: #858580;">)</span> l2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Schreiben Sie eine Funktion <code>mult-2-num-lists</code>, die zwei gleich lange
Listen mit Zahlen zu einer Liste verarbeitet, die die Produkte der
korrespondierenden Elemente der Argumentlisten enthält. Beispiel:
</p>
<pre class="example">
(mult-2-num-lists ’(2 3 4) ’(7 8 9)) =&gt; ’(14 24 36)
</pre>

<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">1. empty oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">2. (cons z lvz), wobei z eine Zahl </span>
   <span style="color: #8D8D84;">;;                   </span><span style="color: #8D8D84; font-style: italic;">und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mult-2-num-lists : (list-of number) (list-of number) -&gt; (list-of number)</span>

   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mult-2-num-lists '<span style="color: #909183;">(</span>2 3 4<span style="color: #909183;">)</span> '<span style="color: #909183;">(</span>7 8 9<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>14 24 36<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mult-2-num-lists '<span style="color: #909183;">()</span> '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">mult-2-num-lists</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>l1 l2<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l1<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>* <span style="color: #858580;">(</span>first l1<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>first l2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                              <span style="color: #6276BA;">(</span>mult-2-num-lists <span style="color: #858580;">(</span>rest l1<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>rest l2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Entwickeln Sie eine Funktion <code>merge</code>, die 2 Listen von Zahlen
verarbeitet, die aufsteigend sortiert sind. Sie liefert eine
sortierte Liste von Zahlen, die alle Zahlen aus den beiden
Argumentlisten enthält. Wenn Zahlen in den Argumentliste mehrfach
vorkommen, sollen Sie auch in der Ergebnisliste entsprechend oft
auftauchen. Beispiel:
</p>
<pre class="example">
(merge ’(2 5 7) ’(1 3 5 9)) =&gt; ’(1 2 3 5 5 7 9)
</pre>

<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenstellung</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datendefinition</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste-von-Zahlen ist entweder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">1. empty oder</span>
   <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">2. (cons z lvz), wobei z eine Zahl </span>
   <span style="color: #8D8D84;">;;                   </span><span style="color: #8D8D84; font-style: italic;">und lvz eine Liste-von-Zahlen ist</span>
   <span style="color: #8D8D84;">;; </span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">merge : (list-of number) (list-of number) -&gt; (list-of number)</span>

   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>merge '<span style="color: #909183;">(</span>2 3 4 11<span style="color: #909183;">)</span> '<span style="color: #909183;">(</span>1 4 7 8 9<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1 2 3 4 4 7 8 9 11<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
   <span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>merge '<span style="color: #909183;">()</span> '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">merge</span>
          <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>l1 l2<span style="color: #909183;">]</span>
            <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l1<span style="color: #907373;">)</span> l2<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? l2<span style="color: #907373;">)</span> l1<span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&lt; <span style="color: #6276BA;">(</span>first l1<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>first l2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first l1<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>merge <span style="color: #858580;">(</span>rest l1<span style="color: #858580;">)</span> l2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
                  <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first l2<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>merge l1 <span style="color: #858580;">(</span>rest l2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org06d947b" class="outline-2">
<h2 id="formaleaspekte"><span class="section-number-2">19</span> Aufgabe (Formale Aspekte)</h2>
<div class="outline-text-2" id="text-formaleaspekte">
<ol class="org-ol">
<li><p>
Werten Sie die folgenden Ausdrücke Schritt für Schritt aus:
</p>
<dl class="org-dl">
<dt>Ausdruck 1</dt><dd><div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= 0 0 <span style="color: #909183;">)</span> false<span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>&gt; 0 1 <span style="color: #909183;">)</span> <span style="color: #909183;">(</span>equal? 'a 'a<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span> = <span style="color: #709870;">(</span>/ 1 0 <span style="color: #709870;">)</span> 9<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
</pre>
</div></dd>
</dl>
<div class="org-src-container">
<pre class="src src-scheme">    <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= 0 0 <span style="color: #909183;">)</span> false<span style="color: #7388D6;">]</span>
      <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>&gt; 0 1 <span style="color: #909183;">)</span> <span style="color: #909183;">(</span>equal? 'a 'a<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
      <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span> = <span style="color: #709870;">(</span>/ 1 0 <span style="color: #709870;">)</span> 9<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span> 
            <span style="color: #7388D6;">[</span>true false<span style="color: #7388D6;">]</span>
                ...<span style="color: #707183;">)</span>
        = false
</pre>
</div>
<dl class="org-dl">
<dt>Ausdruck 2</dt><dd><div class="org-src-container">
<pre class="src src-scheme">      <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span> 
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= 2 0<span style="color: #909183;">)</span> false<span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>&gt; 2 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>equal? 'a 'a <span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span> / 1 2<span style="color: #709870;">)</span> 9<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
</pre>
</div></dd>
</dl>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span> 
      <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= 2 0<span style="color: #909183;">)</span> false<span style="color: #7388D6;">]</span>
      <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>&gt; 2 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>equal? 'a 'a <span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
      <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span> / 1 2<span style="color: #709870;">)</span> 9<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #7388D6;">[</span>false false<span style="color: #7388D6;">]</span>
                ...<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>&gt; 2 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>equal? 'a 'a<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
                ...<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span> 
            <span style="color: #7388D6;">[</span>true <span style="color: #909183;">(</span>equal? 'a 'a<span style="color: #909183;">)</span><span style="color: #7388D6;">]</span>
                ...<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span>equal? 'a 'a<span style="color: #707183;">)</span>
        = true
</pre>
</div></li>
<li><p>
Gegeben sei folgende Racket-Funktion
</p>

<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">f</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= n 0<span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>f <span style="color: #858580;">(</span>- n 1<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                   <span style="color: #6276BA;">(</span>/ 1 <span style="color: #858580;">(</span>* n <span style="color: #80A880;">(</span>+ n 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<p>
Zeigen Sie, dass der Aufruf <code>(f n)</code> für alle natürlichen Zahlen \[n >= 0\] die Zahl \[f(n)=\frac{n}{n+1}\]
berechnet.
</p>
<p>
Behauptung: 
Der Aufruf (f 0) liefert für jede natürliche Zahl \(n >= 0\) den Wert
\(\frac{n}{n+1}\) als Resultat.
</p>

<p>
Verankerung
Der Aufruf (f 0) besitzt Rekursionstiefe 0 und liefert nach dem Ersetzungsmodell:
</p>
<div class="org-src-container">
<pre class="src src-scheme">   
   <span style="color: #707183;">(</span>f 0<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= n 0<span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>f <span style="color: #858580;">(</span>- n 1<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                   <span style="color: #6276BA;">(</span>/ 1 <span style="color: #858580;">(</span>* n <span style="color: #80A880;">(</span>+ n 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
          0<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= 0 0<span style="color: #909183;">)</span> 0<span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>f <span style="color: #907373;">(</span>- 0 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>/ 1 <span style="color: #907373;">(</span>* 0 <span style="color: #6276BA;">(</span>+ 0 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #7388D6;">[</span>true 0<span style="color: #7388D6;">]</span>
                ...<span style="color: #707183;">)</span>
        = 0
</pre>
</div>
<p>
= \(\frac{0}{0+1}\)
</p>

<p>
Induktionsannahme:
Die Behauptung gilt für eine Rekursionstiefe \(k = m\), d. h. \((f m)=\frac{m}{m+1}\). 
</p>

<p>
Induktionsschluss:  
Es ist zu zeigen, dass der Aufruf <code>(f (+ m 1))</code> den Wert 
\(\frac{m+1}{m+2}\) als Resultat liefert. 
</p>

<p>
Sei x = (+ m 1)
</p>
<div class="org-src-container">
<pre class="src src-scheme">        <span style="color: #707183;">(</span>f x<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
             <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> 
           <span style="color: #709870;">[</span><span style="color: #907373;">(</span>= n 0<span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
           <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>+ <span style="color: #6276BA;">(</span>f <span style="color: #858580;">(</span>- n 1<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                    <span style="color: #6276BA;">(</span>/ 1 <span style="color: #858580;">(</span>* n <span style="color: #80A880;">(</span>+ n 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> x<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span> 
        <span style="color: #7388D6;">[</span><span style="color: #909183;">(</span>= x 0<span style="color: #909183;">)</span> 0<span style="color: #7388D6;">]</span>
        <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>f <span style="color: #907373;">(</span>- x 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>/ 1 <span style="color: #907373;">(</span>* x <span style="color: #6276BA;">(</span>+ x 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #7388D6;">[</span>#false 0<span style="color: #7388D6;">]</span>                       x &gt; 0, da 
                                                 x = m+1 und m &gt;= 0
                ...<span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span><span style="color: #0000FF;">cond</span>
        <span style="color: #7388D6;">[</span>else <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>f <span style="color: #907373;">(</span>- x 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span>/ 1 <span style="color: #907373;">(</span>* x <span style="color: #6276BA;">(</span>+ x 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>
        = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>f <span style="color: #909183;">(</span>- x 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 1 <span style="color: #909183;">(</span>* x <span style="color: #709870;">(</span>+ x 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
        
        Setze f&#252;r x wieder <span style="color: #707183;">(</span>+ m 1<span style="color: #707183;">)</span> ein: 
        = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>f <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>+ m 1<span style="color: #709870;">)</span> 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 1 <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span>+ m 1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>+ m 1<span style="color: #907373;">)</span> 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
        
        = <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>f m<span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>/ 1 <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span>+ m 1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>+ m 1<span style="color: #907373;">)</span> 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Wechsel auf die mathematische Notation:<br />
\(= f(m) + \frac{1}{(m + 1) * (m + 2)}\) 
</p>

<p>
\(= \frac{m}{m+1} + \frac{1}{(m + 1) * (m + 2)}\)
</p>

<p>
\(= \frac{m \cdot (m + 2) + 1}{(m + 1) \cdot (m + 2)}\)
</p>

<p>
\(= \frac{m^2 + 2m + 1}{(m + 1) \cdot (m + 2)}\)
</p>

<p>
\(= \frac{(m + 1)^2}{(m + 1) \cdot (m + 2)}\)
</p>

<p>
\(= \frac{m + 1}{m + 2}\)
</p></li>
</ol>
</div>
</div>
<div id="outline-container-org3092624" class="outline-2">
<h2 id="org3092624"><span class="section-number-2">20</span> Aufgabe (lokale Definitionen)</h2>
<div class="outline-text-2" id="text-20">
<ol class="org-ol">
<li><p>
Schreiben Sie unter Anwendung der Regeln 11 bis 13 eine Funktion
<code>exchange</code>, die eine Liste von Symbolen <code>l</code> und zwei Symbole <code>s1</code>
und <code>s2</code> als
Argumente erwartet und eine Liste als Resultat liefert, bei der
jedes Auftreten von <code>s1</code> in <code>l</code> durch <code>s2</code> ersetzt ist. So
soll z. B. der Aufruf
</p>
<pre class="example">
(exchange '(a b c a c) 'a 'f)
</pre>

<p>
das Resultat
</p>
<pre class="example">
(list 'f 'b 'c 'f 'c)
</pre>

<p>
liefern.
</p>

<p>
Modifizieren Sie anschließend die Funktion so, dass durch
Verwendung von lokalen Variablen Mehrfachberechnungen des gleichen
Ausdrucks vermieden werden.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabestellung</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">exchange: (list-of symbol) symbol symbol -&gt; symbol</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>exchange '<span style="color: #909183;">()</span> 'a 'f<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>exchange '<span style="color: #909183;">(</span>a<span style="color: #909183;">)</span> 'a 'f<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>f<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>exchange '<span style="color: #909183;">(</span>b<span style="color: #909183;">)</span> 'a 'f<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>b<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>exchange '<span style="color: #909183;">(</span>a b c a c<span style="color: #909183;">)</span> 'a 'f<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>f b c f c<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(define exchange</span>
<span style="color: #8D8D84;">;   </span><span style="color: #8D8D84; font-style: italic;">(lambda (lvs s1 s2)</span>
<span style="color: #8D8D84;">;     </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[(empty? lvs) empty]</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[else</span>
<span style="color: #8D8D84;">;        </span><span style="color: #8D8D84; font-style: italic;">(cond </span>
<span style="color: #8D8D84;">;          </span><span style="color: #8D8D84; font-style: italic;">[(equal? (first lvs) s1) (cons s2 (exchange (rest lvs) s1 s2))]</span>
<span style="color: #8D8D84;">;          </span><span style="color: #8D8D84; font-style: italic;">[else (cons (first lvs) (exchange (rest lvs) s1 s2))])])))</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">exchange</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">(</span>lvs s1 s2<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? lvs<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else
       <span style="color: #907373;">(</span><span style="color: #0000FF;">let</span> <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>rest-exchngd <span style="color: #80A880;">(</span>exchange <span style="color: #887070;">(</span>rest lvs<span style="color: #887070;">)</span> s1 s2<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">]</span>
         <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
           <span style="color: #858580;">[</span><span style="color: #80A880;">(</span>equal? <span style="color: #887070;">(</span>first lvs<span style="color: #887070;">)</span> s1<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>cons s2 rest-exchngd<span style="color: #80A880;">)</span><span style="color: #858580;">]</span>
           <span style="color: #858580;">[</span>else <span style="color: #80A880;">(</span>cons <span style="color: #887070;">(</span>first lvs<span style="color: #887070;">)</span> rest-exchngd<span style="color: #80A880;">)</span><span style="color: #858580;">]</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Bildung der ersten Ableitung mathematischer Formeln (symbolische
Differentiation)
</p>

<p>
Es sollen Ausdrücke abgeleitet werden, die nur aus Konstanten,
Variablen und den Operationen \(+\) und \(\cdot\) bestehen.
</p>

<p>
Sei \(D_x\) die partielle Ableitung einer Funktion \(f\) nach \(x\), dann
gelten folgende Regeln:
</p>
<ul class="org-ul">
<li>\(D_x(x) = 1\)</li>
<li>\(D_x(y) = 0\), \(y\neq x\), sei \(y\) eine Konstante oder Variable</li>
<li>\(D_x(e_1 + e_2) = D_x(e_1)+D_x(e_2)\) (Summenregel)</li>
<li>\(D_x(e_1\cdot e_2) = e_1\cdot D_x(e_2) + e_2\cdot D_x(e_1)\) (Produktregel)</li>
</ul>
<p>
Repräsentation der Formeln:
</p>
<ul class="org-ul">
<li>Konstante: numerisches Atom</li>
<li>Variable: symbolisches Atom</li>
<li>\(e_1 + e_2\): (ADD \(e_1\) \(e_2\))</li>
<li>\(e_1 \cdot e_2\): (MUL \(e_1\) \(e_2\))</li>
</ul>
<p>
Anwendungsbeispiele:
</p>
<ol class="org-ol">
<li><p>
Der Ausdruck <br />
</p>
<pre class="example">
(diff '(add x x) x)
</pre>

<p>
liefere '<code>(add 1 1)</code>
</p></li>
<li><p>
Der Ausdruck <br />
</p>
<pre class="example">
(diff '(mul x x) 'x)
</pre>

<p>
liefere '<code>(add (mul x 1) (mul 1 x))</code>.<br />
</p></li>
</ol>
<p>
Hinweise:
</p>
<ul class="org-ul">
<li>Definieren Sie zur Erzeugung von Formeln geeignete Hilfsfunktionen!</li>
<li>Wenn eine Formel nicht korrekt aufgebaut ist, kann das Symbol
’ERROR zurückgeliefert werden, das möglicherweise in einem
korrekten Teil der Formel eingeschachtelt erscheint.</li>
<li>Machen Sie ausgiebig von lokalen Definitionen Gebrauch.</li>
</ul>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sung ohne Vereinfachung der abgeleiteten Ausdr&#252;cke       ;;</span>
<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datenstrukturdefinition fuer Formeln: Eine formel ist</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- numerisches Atom oder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- symbolisches Atom oder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (add e1 e2) mit e1, e2 sind Formeln, oder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (mul e1 e2) mit e1, e2 sind Formeln</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">Hilfsdefinitionen</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">addop</span> 'add<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">mulop</span> 'mul<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;</span><span style="color: #8D8D84; font-style: italic;">ein paar Variablen</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">x</span> 'x<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">y</span> 'y<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">z</span> 'z<span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">baut aus den beiden Argumenten eine Summenformel</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add: formel formel -&gt; formel</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add x y<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>add x y<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">add</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>u v<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>cons addop <span style="color: #709870;">(</span>cons u <span style="color: #907373;">(</span>cons v empty<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">baut aus den beiden Argumenten eine Produktformel</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mul: formel formel -&gt; formel</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul x y<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>mul x y<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">mul</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>u v<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>cons mulop <span style="color: #709870;">(</span>cons u <span style="color: #907373;">(</span>cons v empty<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">bildet die erste Ableitung der Formel exp nach der Variablen var.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Regeln s. Aufgabenblatt</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">diff: formel symbol -&gt; formel</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>diff 1 x<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>diff x x<span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>diff y x<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>diff '<span style="color: #909183;">(</span>add x x<span style="color: #909183;">)</span> x<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>add 1 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>diff '<span style="color: #909183;">(</span>mul x x<span style="color: #909183;">)</span> 'x<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>add <span style="color: #909183;">(</span>mul x 1<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>mul 1 x<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">diff</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>exp var<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">let*</span> 
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>operand-1 
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>s<span style="color: #858580;">]</span> <span style="color: #858580;">(</span>first <span style="color: #80A880;">(</span>rest s<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>operand-2 
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>s<span style="color: #858580;">]</span> <span style="color: #858580;">(</span>first <span style="color: #80A880;">(</span>rest <span style="color: #887070;">(</span>rest s<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>variable?
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>x<span style="color: #858580;">]</span> <span style="color: #858580;">(</span>symbol? x<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>same-variable? 
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>v1 v2<span style="color: #858580;">]</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>variable? v1<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>variable? v2<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>equal? v1 v2<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>add? <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob formula eine Summe ist</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>formula<span style="color: #858580;">]</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>cons? formula<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>equal? <span style="color: #887070;">(</span>first formula<span style="color: #887070;">)</span> addop<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>mul? <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob formula ein Produkt ist</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>formula<span style="color: #858580;">]</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>cons? formula<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>equal? <span style="color: #887070;">(</span>first formula<span style="color: #887070;">)</span> mulop<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #907373;">[</span><span style="color: #6276BA;">(</span>number? exp<span style="color: #6276BA;">)</span> 0<span style="color: #907373;">]</span>
            <span style="color: #907373;">[</span><span style="color: #6276BA;">(</span>variable? exp<span style="color: #6276BA;">)</span>
             <span style="color: #6276BA;">(</span><span style="color: #0000FF;">if</span> <span style="color: #858580;">(</span>same-variable? exp var<span style="color: #858580;">)</span> 1 0<span style="color: #6276BA;">)</span><span style="color: #907373;">]</span>
            <span style="color: #907373;">[</span><span style="color: #6276BA;">(</span>add? exp<span style="color: #6276BA;">)</span>
             <span style="color: #6276BA;">(</span>add <span style="color: #858580;">(</span>diff <span style="color: #80A880;">(</span>operand-1 exp<span style="color: #80A880;">)</span> var<span style="color: #858580;">)</span>
                  <span style="color: #858580;">(</span>diff <span style="color: #80A880;">(</span>operand-2 exp<span style="color: #80A880;">)</span> var<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span>
            <span style="color: #907373;">[</span><span style="color: #6276BA;">(</span>mul? exp<span style="color: #6276BA;">)</span>
             <span style="color: #6276BA;">(</span>add
              <span style="color: #858580;">(</span>mul <span style="color: #80A880;">(</span>operand-1 exp<span style="color: #80A880;">)</span>
                    <span style="color: #80A880;">(</span>diff <span style="color: #887070;">(</span>operand-2 exp<span style="color: #887070;">)</span> var<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
              <span style="color: #858580;">(</span>mul <span style="color: #80A880;">(</span>diff <span style="color: #887070;">(</span>operand-1 exp<span style="color: #887070;">)</span> var<span style="color: #80A880;">)</span>
                    <span style="color: #80A880;">(</span>operand-2 exp<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span>
         <span style="color: #907373;">[</span>else 'Error<span style="color: #907373;">]</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sung mit Vereinfachung der abgeleiteten Ausdr&#252;cke        ;;</span>
<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ersetze die obigen Funktionen add und mul durch die folgenden:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt primitive Vereinfachungen einer Summenformel vor; eine Summenformel</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">vereinfacht sich quasi selbst</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add: formel formel -&gt; formel</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add x 0<span style="color: #7388D6;">)</span> x<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add 0 x<span style="color: #7388D6;">)</span> x<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add 2 3<span style="color: #7388D6;">)</span> 5<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add x y<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>add x y<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">add</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>=number? x 0<span style="color: #907373;">)</span> y<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>=number? y 0<span style="color: #907373;">)</span> x<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>number? x<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>number? y<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>+ x y<span style="color: #907373;">)</span><span style="color: #709870;">]</span> 
      <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>list 'add x y<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mul: exp exp -&gt; exp</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt primitive Vereinfachungen einer Produktformel vor; eine Produktformel</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">vereinfacht sich quasi selbst</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul x 0<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul x 1<span style="color: #7388D6;">)</span> x<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul 1 x<span style="color: #7388D6;">)</span> x<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul 2 3<span style="color: #7388D6;">)</span> 6<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>mul x y<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>mul x y<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">mul</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> 
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>=number? x 0<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>=number? y 0<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 0<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>=number? y 1<span style="color: #907373;">)</span> x<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>=number? x 1<span style="color: #907373;">)</span> y<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> <span style="color: #6276BA;">(</span>number? x<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>number? y<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>* x y<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>list 'mul x y<span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-org475849f" class="outline-2">
<h2 id="org475849f"><span class="section-number-2">21</span> Aufgabe (Listen über gemischten Daten &#x2013; Zusatzaufgabe)</h2>
<div class="outline-text-2" id="text-21">
<p>
Diese Aufgabe ist eine Fortführung der Aufgaben 13 und 15. Dort haben
Sie Funktionen zum Bewegen einzelner Figuren (shapes) geschrieben. Ein Bild
hingegen besteht aus einer Sammlung von Figuren. Um Bilder zeichnen,
verschieben und löschen zu können ist es sinnvoll, alle Bildteile
(Figuren) in einer Datenstruktur zusammen zu fassen. Da die Anzahl der
Figuren eines Bildes von Bild zu Bild variieren kann, bietet es sich
an, die Figuren eines Bildes in einer Liste zu verwalten. 
</p>

<ol class="org-ol">
<li>Beschreiben Sie eine Datendefinition für Listen von Figuren.</li>
<li><p>
Erzeugen Sie eine Beispielliste (genannt face), die aus den Figuren
der folgenden Tabelle besteht:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Figur</th>
<th scope="col" class="org-left">Position</th>
<th scope="col" class="org-left">Größen</th>
<th scope="col" class="org-left">Farbe</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">circle</td>
<td class="org-left">(50,50)</td>
<td class="org-left">40</td>
<td class="org-left">red</td>
</tr>

<tr>
<td class="org-left">rectangle</td>
<td class="org-left">(30,20)</td>
<td class="org-left">5 × 5</td>
<td class="org-left">blue</td>
</tr>

<tr>
<td class="org-left">rectangle</td>
<td class="org-left">(65,20)</td>
<td class="org-left">5 × 5</td>
<td class="org-left">blue</td>
</tr>

<tr>
<td class="org-left">rectangle</td>
<td class="org-left">(40,75)</td>
<td class="org-left">20 × 10</td>
<td class="org-left">red</td>
</tr>

<tr>
<td class="org-left">rectangle</td>
<td class="org-left">(45,35)</td>
<td class="org-left">10 × 30</td>
<td class="org-left">blue</td>
</tr>
</tbody>
</table>

<p>
Die Tabelle setzt eine Zeichenfläche der Größe 300 x 100 voraus.
</p></li>
<li>Entwickeln Sie eine Funktionsschablone für figurenverarbeitende
Funktionen.</li>
<li>Entwickeln Sie auf der Grundlage dieser Funktionsschablone eine
Funktion <code>draw-losh</code>, die eine Liste von Figuren als Argument
erwartet und alle Elemente der Liste zeichnet und <code>#true</code> zurückliefert.</li>
<li>Entwickeln Sie eine Funktion <code>translate-losh</code>, die eine Liste von
Figuren sowie eine <code>posn</code>-Struktur <code>delta</code> als Argumente akzeptiert
und eine Liste von Figuren als Resultat liefert, in der alle
Figuren der Argumentliste um <code>delta</code> verschoben sind. Die Funktion
hat keinen Effekt auf der Zeichenfläche.</li>
<li>Entwicklen Sie die Funktion <code>clear-losh</code>, die die eine Liste von Figuren als Argument
erwartet und alle Elemente der Liste von der Zeichenfläche
entfernt und <code>#true</code> zurückliefert.</li>
<li>Entwicklen Sie die Funktion <code>draw-and-clear-picture</code>. Sie zeichnet
ein Bild, wartet eine Weile und löscht anschließend das Bild von
der Zeichenfläche.</li>
<li><p>
Entwicklen Sie die Funktion <code>move-picture</code>, die eine
<code>posn</code>-Struktur <code>delta</code> und ein Bild als Argumente akzeptiert. Sie zeichnet
ein Bild, wartet eine Weile und löscht anschließend das Bild von
der Zeichenfläche. Sie liefert als Resultat das um <code>delta</code>
verschobene Bild. 
</p>

<p>
Testen Sie die Funktion z. B. so
</p>
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #707183;">(</span>start 500 100<span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span>draw-losh
     <span style="color: #7388D6;">(</span>move-picture <span style="color: #909183;">(</span>make-posn -5 0<span style="color: #909183;">)</span>
       <span style="color: #909183;">(</span>move-picture <span style="color: #709870;">(</span>make-pos 23 0<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>move-picture <span style="color: #907373;">(</span>make-pos 10 0<span style="color: #907373;">)</span> face<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span>stop<span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-orgc5e8f18" class="outline-2">
<h2 id="akkumulierendeparameter"><span class="section-number-2">22</span> Aufgabe (Hilfsfunktionen mit akkumulierenden Parametern)</h2>
<div class="outline-text-2" id="text-akkumulierendeparameter">
<ol class="org-ol">
<li><p>
Schreiben Sie die Funktion <code>sum</code>, die die Summe der
Elemente einer Liste von Zahlen berechnet, unter Benutzung einer
Hilfsfunktion mit akkumulierendem Parameter.  Verwenden Sie die
Funktiosnschablone aus der Vorlesung.  Formulieren Sie die
Akkumulatorinvariante.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Summe einer Liste von Zahlen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum: (list-of number) -&gt; number</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">(</span>1 2 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 6<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sum</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>alon<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Akkumulatorinvariante:</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">accu enth&#228;lt die Summe der Elemente aus alon, die denen aus alon1</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">vorangehen</span>
          sum-acc
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>alon1 accu<span style="color: #858580;">]</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
              <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? alon1<span style="color: #887070;">)</span> accu<span style="color: #80A880;">]</span>
              <span style="color: #80A880;">[</span>else 
               <span style="color: #887070;">(</span>sum-acc <span style="color: #707183;">(</span>rest alon1<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>first alon1<span style="color: #7388D6;">)</span> accu<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>sum-acc alon 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
Gegeben ist ein Weg in einem ungerichteten Graphen, dessen 
Knoten Orte repräsentieren und dessen Kanten mit den Entfernungen 
zwischen den Orten attributiert sind, z. B. so:
</p>


<div class="figure">
<p><img src="./Abbildungen/entfernungen.png" alt="entfernungen.png" />
</p>
</div>

<p>
Entwickeln Sie eine Funktion, die aus einer Liste mit relativen 
Entfernungen eine Liste mit den absoluten Entfernungen der Orte 
vom Ursprungsort berechnet. Für den obigen Graphen soll also aus 
der Liste (120 90 70 65) die Liste (120 210 280 345) werden.
</p>
<ol class="org-ol">
<li>Entwickeln Sie zunächst eine Funktion (ggf. mit Hilfsfunktion)
nach den bekannten Regeln (ohne akkumulierende
Parameter).</li>
<li>Diskutieren Sie, warum eine Hilfsfunktion mit akkumulierendem
Parameter sinnvoll ist.</li>
<li>Entwickeln Sie eine solche.</li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sung ohne akkumulierenden Parameter</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(define relativ-&gt;absolut</span>
<span style="color: #8D8D84;">;   </span><span style="color: #8D8D84; font-style: italic;">(lambda [lvz]</span>
<span style="color: #8D8D84;">;     </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[(empty? lvz) empty]</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[else </span>
<span style="color: #8D8D84;">;        </span><span style="color: #8D8D84; font-style: italic;">(cons (first lvz)</span>
<span style="color: #8D8D84;">;              </span><span style="color: #8D8D84; font-style: italic;">(addiere-auf-jede (first lvz) (relativ-&gt;absolut (rest lvz))))])))</span>
<span style="color: #8D8D84;">; </span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(define addiere-auf-jede </span>
<span style="color: #8D8D84;">;   </span><span style="color: #8D8D84; font-style: italic;">(lambda [zahl lvz]</span>
<span style="color: #8D8D84;">;     </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[(empty? lvz) empty]</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">[else (cons (+ (first lvz) zahl) (addiere-auf-jede zahl (rest lvz)))])))</span>
<span style="color: #8D8D84;">; </span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Warum akkumulierender Parameter? Weil die Hilfsfunktion wie die Hauptfunktion</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">die Liste rekursiv abarbeitet!</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Was ist zu akkumulieren?</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Das Problem besteht darin, dass der rekursive Aufruf (relativ-&gt;absolut (rest lvz)) nichts</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">von dem Wert des ersten Elements "wei&#223;". Dieses Problem kann gel&#246;st werden, indem man in</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">einem Parameter die Distanz vom Ursprung zu akkumulieren. Das f&#252;hrt zu folgender L&#246;sung:</span>

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">;; relativ-&gt;absolut: (list-of number) -&gt; (list-of number)</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(check-expect (relativ-&gt;absolut '(50 40 70 30 30))</span>
<span style="color: #8D8D84;">;               </span><span style="color: #8D8D84; font-style: italic;">(list 50 90 160 190 220))</span>
<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">(define relativ-&gt;absolut</span>
<span style="color: #8D8D84;">;   </span><span style="color: #8D8D84; font-style: italic;">(lambda [lvz]</span>
<span style="color: #8D8D84;">;     </span><span style="color: #8D8D84; font-style: italic;">(letrec</span>
<span style="color: #8D8D84;">;         </span><span style="color: #8D8D84; font-style: italic;">[(;; Akkumulatorinvariante: akku-distanz ist die akkumulierte Distanz</span>
<span style="color: #8D8D84;">;           </span><span style="color: #8D8D84; font-style: italic;">;; derjenigen Elemente von lvz, die denen aus lvz1 vorangehen.</span>
<span style="color: #8D8D84;">;           </span><span style="color: #8D8D84; font-style: italic;">relabs (lambda [lvz1 akku-distanz]</span>
<span style="color: #8D8D84;">;                    </span><span style="color: #8D8D84; font-style: italic;">(cond</span>
<span style="color: #8D8D84;">;                      </span><span style="color: #8D8D84; font-style: italic;">[(empty? lvz1) empty]</span>
<span style="color: #8D8D84;">;                      </span><span style="color: #8D8D84; font-style: italic;">[else </span>
<span style="color: #8D8D84;">;                       </span><span style="color: #8D8D84; font-style: italic;">(cons (+ akku-distanz (first lvz1))</span>
<span style="color: #8D8D84;">;                             </span><span style="color: #8D8D84; font-style: italic;">(relabs (rest lvz1) (+ akku-distanz (first lvz1))))])))]</span>
<span style="color: #8D8D84;">;       </span><span style="color: #8D8D84; font-style: italic;">(relabs lvz 0))))</span>
<span style="color: #8D8D84;">; </span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">relabs ist aber nicht endrekursiv. Das kann erreicht werden, indem in einem</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">weiteren akkumulierenden Parameter akku-entfrnngn die Ergebnisliste aufgebaut wird.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Man beachte, dass die Liste dabei in umgekehrter Reihenfolge entsteht.</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">relativ-&gt;absolut: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>relativ-&gt;absolut '<span style="color: #909183;">(</span>50 40 70 30 30<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>list 50 90 160 190 220<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">relativ-&gt;absolut</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Akkumulatorinvariante: akku-distanz ist die akkumulierte Distanz</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">derjenigen Elemente von lvz, die denen aus lvz1 vorangehen.</span>
          relabs <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>lvz1 akku-distanz akku-entfrnngn<span style="color: #858580;">]</span>
                   <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
                     <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? lvz1<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>reverse akku-entfrnngn<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
                                     <span style="color: #8D8D84;">;;;;;;;</span>
                     <span style="color: #80A880;">[</span>else          
                      <span style="color: #887070;">(</span>relabs <span style="color: #707183;">(</span>rest lvz1<span style="color: #707183;">)</span>
                              <span style="color: #707183;">(</span>+ akku-distanz <span style="color: #7388D6;">(</span>first lvz1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                              <span style="color: #707183;">(</span>cons <span style="color: #7388D6;">(</span>+ akku-distanz <span style="color: #909183;">(</span>first lvz1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> akku-entfrnngn<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>relabs lvz 0 '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li><p>
Definieren Sie eine Funktion <code>(singletons x)</code>, die als Argument
eine Liste von den Atomen <code>x</code> hat und als Ergebnis eine Liste von
den Atomen liefern soll, die in <code>x</code> genau einmal auftreten.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">"klassische" Loesung mit natuerlicher Rekursion nach den Regeln</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">f&#252;r listenverarbeitende Funktionen</span>

<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">Test-Hilfsprozedur</span>
<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">erzeugt Liste mit anzahl-maligem Auftreten von x</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">vervielfache</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x anzahl<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&lt;= anzahl 0<span style="color: #907373;">)</span> '<span style="color: #907373;">()</span><span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons x <span style="color: #6276BA;">(</span>vervielfache x <span style="color: #858580;">(</span>- anzahl 1<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">entfernt jedes Auftreten von elem in list</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">eliminate: X (listof X) -&gt; (listof X)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>eliminate 2 '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>eliminate 2 '<span style="color: #909183;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1 3 3 1 4 5 4<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>eliminate 6 '<span style="color: #909183;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">eliminate</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>elem list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? list<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>equal? elem <span style="color: #6276BA;">(</span>first list<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
       <span style="color: #907373;">(</span>eliminate elem <span style="color: #6276BA;">(</span>rest list<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons <span style="color: #6276BA;">(</span>first list<span style="color: #6276BA;">)</span> 
                  <span style="color: #6276BA;">(</span>eliminate elem <span style="color: #858580;">(</span>rest list<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">entfernt jedes Duplikat aus list</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singletons: (listof X) -&gt; (listof X)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons empty<span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons '<span style="color: #909183;">(</span>a<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>a<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons '<span style="color: #909183;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>5<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons '<span style="color: #909183;">(</span>1 1 5 2 3 3 2 1 4 5 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons <span style="color: #909183;">(</span>vervielfache 'a 10001<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">[</span><span style="color: #907373;">(</span>empty? list<span style="color: #907373;">)</span> empty<span style="color: #709870;">]</span>
      <span style="color: #709870;">[</span>else 
       <span style="color: #907373;">(</span><span style="color: #0000FF;">let</span> <span style="color: #6276BA;">[</span><span style="color: #858580;">(</span>singlerest <span style="color: #80A880;">(</span>singletons <span style="color: #887070;">(</span>rest list<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">]</span>
         <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
           <span style="color: #858580;">[</span><span style="color: #80A880;">(</span>member? <span style="color: #887070;">(</span>first list<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>rest list<span style="color: #887070;">)</span><span style="color: #80A880;">)</span> 
            <span style="color: #80A880;">(</span>eliminate <span style="color: #887070;">(</span>first list<span style="color: #887070;">)</span> singlerest<span style="color: #80A880;">)</span><span style="color: #858580;">]</span>
           <span style="color: #858580;">[</span>else <span style="color: #80A880;">(</span>cons <span style="color: #887070;">(</span>first list<span style="color: #887070;">)</span> singlerest<span style="color: #80A880;">)</span><span style="color: #858580;">]</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
<li value="4"><p>
Modifizieren die Funktion <code>(singletons x)</code> so, dass zwei
akkumulierende Parameter verwendet werden.  Der eine soll zum
Akkumulieren der Atome, die genau einmal in <code>x</code> auftreten, dienen,
der andere zum Akkumulieren der Atome, die mehrmals in <code>x</code>
auftreten.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">entfernt jedes Duplikat aus list</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singletons: (list-of atom) -&gt; (list-of atom)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons empty<span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons '<span style="color: #909183;">(</span>1 2 3 3 2 1 3 4 5 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>5<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>singletons <span style="color: #909183;">(</span>vervielfache 1 100000<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> empty<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Fuer den Listenkopf ueberpruefe zuerst, ob er schon in</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">multis vorhanden ist. </span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Wenn ja, braucht er nicht weiter verarbeitet zu werden. </span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Wenn nein, muss er zu multis hinzugefuegt werden, </span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">wenn er im Listenrumpf noch einmal auftritt, sonst zu</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singles.</span>
          singletonsAccu
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>list0 singles multis<span style="color: #858580;">]</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span> 
              <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? list0<span style="color: #887070;">)</span> singles<span style="color: #80A880;">]</span>
              <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>member? <span style="color: #707183;">(</span>first list0<span style="color: #707183;">)</span> multis<span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span>singletonsAccu <span style="color: #707183;">(</span>rest list0<span style="color: #707183;">)</span> singles multis<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
              <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>member? <span style="color: #707183;">(</span>first list0<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>rest list0<span style="color: #707183;">)</span> <span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span>singletonsAccu <span style="color: #707183;">(</span>rest list0<span style="color: #707183;">)</span> 
                               singles 
                               <span style="color: #707183;">(</span>cons <span style="color: #7388D6;">(</span>first list0<span style="color: #7388D6;">)</span> multis<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
              <span style="color: #80A880;">[</span>else
               <span style="color: #887070;">(</span>singletonsAccu <span style="color: #707183;">(</span>rest list0<span style="color: #707183;">)</span> 
                               <span style="color: #707183;">(</span>cons <span style="color: #7388D6;">(</span>first list0<span style="color: #7388D6;">)</span> singles<span style="color: #707183;">)</span> 
                               multis<span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>singletonsAccu list empty empty<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">vervielfache</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">(</span>x anzahl<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>&lt;= anzahl 0<span style="color: #907373;">)</span> '<span style="color: #907373;">()</span><span style="color: #709870;">]</span>
          <span style="color: #709870;">[</span>else <span style="color: #907373;">(</span>cons x <span style="color: #6276BA;">(</span>vervielfache x <span style="color: #858580;">(</span>- anzahl 1<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-org407d38b" class="outline-2">
<h2 id="fho"><span class="section-number-2">23</span> Aufgabe (Anwendung von <code>map</code>, <code>filter</code> und <code>reduce</code>)</h2>
<div class="outline-text-2" id="text-fho">
<p>
Implementieren Sie folgende Funktionen unter Nutzung der Funktionen
<code>filter</code>, <code>reduce</code> und <code>map</code> aus dem Skript:
</p>

<ol class="org-ol">
<li>Eine Funktion, die zu allen Zahlen einer Liste jeweils 42 addiert.</li>
<li>Eine Funktion, die sich wie a) verhält, aber nur die geraden Zahlen
zurückgibt.</li>
<li>Eine Funktion, die sich wie b) verhält, aber das Produkt aller Zahlen
zurückgibt.</li>
<li>Eine Funktion, die aus einer Liste von Zahlen alle Zahlen streicht,
die nicht durch 4 oder 5 teilbar sind.</li>
<li>Eine Funktion, die die Summe der Quadrate der natürlichen Zahlen in
einer Liste berechnet.</li>
<li>Eine Funktion <code>und</code>, die genau dann <code>true</code> zurück liefert, wenn alle
Elemente einer Liste von Booleans <code>true</code> sind.</li>
<li>Eine Funktion <code>partitioniere</code>, die ein Prädikat als Argument nimmt
und, angewandt auf eine Liste, zwei Listen zurückgibt, wobei erstere
alle Elemente enthält, die das Prädikat erfüllen, und die andere die
restlichen Elemente enthält.</li>
<li>Eine Funktion <code>sort</code>, die, angewendet auf eine Liste von Zahlen,
diese Liste absteigend sortiert.</li>
<li><p>
Modifizieren Sie die Funktion <code>sort</code> aus 8. so, dass durch einen
zusätzlichen Parameter die Sortierreihenfolge bestimmt werden kann.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sungen zu Aufgabe 23 ;;;</span>
<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">a) Eine Funktion, die zu allen Zahlen einer Liste jeweils 42 addiert.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add42: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42 '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42 '<span style="color: #909183;">(</span> 3 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>45 <span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42 '<span style="color: #909183;">(</span> 3 4 5 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>45 46 47<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">add42</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">map</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>+ x 42<span style="color: #907373;">)</span><span style="color: #709870;">)</span> lvz<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">b) Eine Funktion, die sich wie a) verh&#228;lt, aber nur die geraden Zahlen zur&#252;ckgibt.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add42even: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42even '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42even '<span style="color: #909183;">(</span> 3 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>add42even '<span style="color: #909183;">(</span> 3 4 5 6<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span> 46 48 <span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">add42even</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
     <span style="color: #909183;">(</span>filter even? <span style="color: #709870;">(</span>add42 lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">c) Eine Funktion, die sich wie b) verh&#228;lt, aber das Produkt aller Zahlen zur&#252;ckgibt.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prod-of-add42even (list-of number) -&gt; number</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod-of-add42even '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod-of-add42even '<span style="color: #909183;">(</span> 3 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>prod-of-add42even '<span style="color: #909183;">(</span> 3 4 5 6 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>* 46 48<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">prod-of-add42even</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>reduce * 1 <span style="color: #709870;">(</span>add42even lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> 
    
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">d) Eine Funktion, die aus einer Liste von Zahlen alle Zahlen streicht,</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">die nicht durch 4 oder 5 teilbar sind.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nur-durch-4-und-5-teilbare: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nur-durch-4-und-5-teilbare '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nur-durch-4-und-5-teilbare '<span style="color: #909183;">(</span> 4 <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>4<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nur-durch-4-und-5-teilbare '<span style="color: #909183;">(</span> 3 4 5 6 8 15 40<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>4 5 8 15 40<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">nur-durch-4-und-5-teilbare</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>filter <span style="color: #709870;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>= <span style="color: #858580;">(</span>modulo x 4<span style="color: #858580;">)</span> 0<span style="color: #6276BA;">)</span>
                            <span style="color: #6276BA;">(</span>= <span style="color: #858580;">(</span>modulo x 5<span style="color: #858580;">)</span> 0<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
            lvz<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">e) Eine Funktion, die die Summe der Quadrate der nat&#252;rlichen Zahlen in einer Liste berechnet.</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">liefert true f&#252;r nat&#252;rliche Zahlen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nat-number?: number -&gt; boolean</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nat-number? -1<span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nat-number? 2.5<span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>nat-number? 11<span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">nat-number?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>x<span style="color: #909183;">]</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>&gt; x 0<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>integer? x<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum-quad-nat: (list-of number) -&gt; number</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum-quad-nat '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum-quad-nat '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum-quad-nat '<span style="color: #909183;">(</span>-2 3.5 2 3 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 29<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sum-quad-nat</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>reduce + 0 <span style="color: #709870;">(</span><span style="color: #0000FF;">map</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>* x x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>filter nat-number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">f) Eine Funktion und, die genau dann true zur&#252;ck liefert, wenn alle Elemente einer</span>
<span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">Liste von Booleans true sind.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">und: (list-of boolean) -&gt; boolean</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>und '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>und '<span style="color: #909183;">(</span>#true<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>und '<span style="color: #909183;">(</span>#false<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>und '<span style="color: #909183;">(</span>#true #true #true<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #true<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>und '<span style="color: #909183;">(</span>#true #true #false<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> #false<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">und</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lvb<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>reduce <span style="color: #709870;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #907373;">[</span>x y<span style="color: #907373;">]</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> x y<span style="color: #907373;">)</span><span style="color: #709870;">)</span> #true lvb<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;;; </span><span style="color: #8D8D84; font-style: italic;">Hinweis: der Aufruf (reduce and #true lvb) ist nicht m&#246;glich, da and keine Funktion sondern eine Pseudofunktion ist</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">g) Eine Funktion partitioniere, die ein Pr&#228;dikat als Argument nimmt und, angewandt auf eine Liste, zwei Listen</span>
<span style="color: #8D8D84;">;;    </span><span style="color: #8D8D84; font-style: italic;">zur&#252;ckgibt, wobei erstere alle Elemente enth&#228;lt, die das Pr&#228;dikat erf&#252;llen, und die andere die restlichen Elemente enth&#228;lt.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">partitioniere: (number-&gt; boolean) (list-of number) -&gt; (list-of (list-of number))</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>partitioniere even? '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">()</span> <span style="color: #909183;">()</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>partitioniere even? '<span style="color: #909183;">(</span>2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>2<span style="color: #909183;">)</span> <span style="color: #909183;">()</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>partitioniere even? '<span style="color: #909183;">(</span>3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">()</span> <span style="color: #909183;">(</span>3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>partitioniere even? '<span style="color: #909183;">(</span>-2 7 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>-2<span style="color: #909183;">)</span> <span style="color: #909183;">(</span>7 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">partitioniere</span>
   <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>praed? lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>list <span style="color: #709870;">(</span>filter praed? lvz<span style="color: #709870;">)</span>
          <span style="color: #709870;">(</span>filter <span style="color: #907373;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>not <span style="color: #858580;">(</span>praed? x<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">h) Eine Funktion sort, die, angewendet auf eine Liste von Zahlen, diese Liste absteigend sortiert.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sortiere: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere '<span style="color: #909183;">(</span>3 4 9 2 1 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>9 4 3 2 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sortiere</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lst<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span> 
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>insert <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>an alon<span style="color: #858580;">]</span>
                   <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
                     <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? alon<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>list an<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
                     <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>&gt; an <span style="color: #707183;">(</span>first alon<span style="color: #707183;">)</span><span style="color: #887070;">)</span> <span style="color: #887070;">(</span>cons an alon<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
                     <span style="color: #80A880;">[</span>else <span style="color: #887070;">(</span>cons <span style="color: #707183;">(</span>first alon<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>insert an <span style="color: #7388D6;">(</span>rest alon<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>reduce insert '<span style="color: #907373;">()</span> lst<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">i) Modifizieren Sie die Funktion sort aus 8. so, dass durch einen zus&#228;tzlichen Parameter die Sortierreihenfolge</span>
<span style="color: #8D8D84;">;;    </span><span style="color: #8D8D84; font-style: italic;">bestimmt werden kann.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sortiere: (list-of number) -&gt; (list-of number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere2 '<span style="color: #909183;">()</span> &lt;<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere2 '<span style="color: #909183;">(</span>1<span style="color: #909183;">)</span> &gt;<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere2 '<span style="color: #909183;">(</span>3 4 9 2 1 2<span style="color: #909183;">)</span> &gt;<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>9 4 3 2 2 1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sortiere2 '<span style="color: #909183;">(</span>3 4 9 2 1 2<span style="color: #909183;">)</span> &lt;<span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>1 2 2 3 4 9<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sortiere2</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>lst auf/ab<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span> 
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>insert <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>an alon<span style="color: #858580;">]</span>
                   <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
                     <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? alon<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>list an<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
                     <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>auf/ab an <span style="color: #707183;">(</span>first alon<span style="color: #707183;">)</span><span style="color: #887070;">)</span> <span style="color: #887070;">(</span>cons an alon<span style="color: #887070;">)</span><span style="color: #80A880;">]</span>
                     <span style="color: #80A880;">[</span>else <span style="color: #887070;">(</span>cons <span style="color: #707183;">(</span>first alon<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>insert an <span style="color: #7388D6;">(</span>rest alon<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>reduce insert '<span style="color: #907373;">()</span> lst<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-orgae7bb50" class="outline-2">
<h2 id="orgae7bb50"><span class="section-number-2">24</span> Aufgabe (Definition von Funktionen höherer Ordnung)</h2>
<div class="outline-text-2" id="text-24">
<p>
Definieren Sie die folgenden Funktionen höherer Ordnung rekursiv oder
durch Verwendung von anderen Funktionen höherer Ordnung:
</p>
<ol class="org-ol">
<li><p>
Eine Funktion
</p>

<div class="org-src-container">
<pre class="src src-scheme">         <span style="color: #707183;">(</span>Number -&gt; Number<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>Number-&gt; Number<span style="color: #707183;">)</span> list-of Number 
            -&gt; list-of Number,
</pre>
</div>
<p>
die zwei Funktionen und eine Liste von Zahlen als Argument erhält und
auf jede Zahl zuerst die erste und dann die zweite Funktion anwendet.
</p></li>
<li><p>
Eine Funktion
</p>

<div class="org-src-container">
<pre class="src src-scheme">          <span style="color: #707183;">(</span>Number -&gt; Number<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>Number -&gt; Number<span style="color: #707183;">)</span> -&gt; Number,
</pre>
</div>
<p>
die zwei Funktionen als Argument erhält und die kleinste natürliche
Zahl sucht, für die diese beiden Funktionen dasselbe Ergebnis
liefern. Begrenzen Sie die Suche auf Zahlen bis 1000 und geben Sie
<code>nil</code> zurück, wenn keine passende Zahl gefunden wurde.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;;; </span><span style="color: #8D8D84; font-style: italic;">L&#246;sungen zu Aufgabe 24 ;;;</span>
<span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">a) Eine Funktion, die zwei Funktionen und eine Liste von Zahlen als Argument erh&#228;lt</span>
<span style="color: #8D8D84;">;;    </span><span style="color: #8D8D84; font-style: italic;">und auf jede Zahl zuerst die erste und dann die zweite Funktion anwendet.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">hintereinander: (Number -&gt; Number) (Number-&gt; Number) (list-of Number) -&gt; (list-of Number)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>hintereinander <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>* x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                              <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- x 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                              '<span style="color: #909183;">()</span><span style="color: #7388D6;">)</span>
              '<span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>hintereinander <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>* x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- x 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span> '<span style="color: #909183;">(</span>3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>7<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>hintereinander <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>* x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- x 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span> '<span style="color: #909183;">(</span>-2 7 5<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> '<span style="color: #7388D6;">(</span>2 47 23<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">hintereinander</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>f g lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">map</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>g <span style="color: #6276BA;">(</span>f x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> lvz<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">b) Eine Funktion, die zwei Funktionen als Argument erh&#228;lt und die kleinste nat&#252;rliche Zahl sucht,</span>
<span style="color: #8D8D84;">;;    </span><span style="color: #8D8D84; font-style: italic;">f&#252;r die diese beiden Funktionen dasselbe Ergebnis liefern. Begrenzen Sie die Suche auf Zahlen bis 1000</span>
<span style="color: #8D8D84;">;;    </span><span style="color: #8D8D84; font-style: italic;">und geben Sie -1 zur&#252;ck, wenn keine passende Zahl gefunden wurde.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">gleiches-ergebnis: (Number -&gt; Number) (Number -&gt; Number) -&gt; Number</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>gleiches-ergebnis <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>* x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                                 <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- x 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              -1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>gleiches-ergebnis + *<span style="color: #7388D6;">)</span> 0<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>gleiches-ergebnis <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>* x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                                 <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- 2 x<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>gleiches-ergebnis <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>- 20 x<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                                 <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">[</span>x<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>+ 2 x<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
              9<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">gleiches-ergebnis</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>f g<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>ge2 <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">[</span>f g n<span style="color: #858580;">]</span>
                    <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
                      <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>= <span style="color: #707183;">(</span>f n<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>g n<span style="color: #707183;">)</span><span style="color: #887070;">)</span> n<span style="color: #80A880;">]</span>
                      <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>= n 1000<span style="color: #887070;">)</span> -1<span style="color: #80A880;">]</span>
                      <span style="color: #80A880;">[</span>else <span style="color: #887070;">(</span>ge2 f g <span style="color: #707183;">(</span>+ n 1<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>ge2 f g 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Johannes Brauer</p>
<p class="date">Created: 2019-02-18 Mon 14:02</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>